# ============================================================================
# File: l3_cache.tcl
# Description: L3 Cache综合脚本
# Version: 1.0
# ============================================================================

# ============================================================================
# 1. 设置
# ============================================================================

set_app_var synopsys_program_root $::env(SYNOPHOME)
set_app_var company "YaoGuang"
set_app_var designer "RTL Team"

# ============================================================================
# 2. 读取库文件
# ============================================================================

set search_path [list . /libs/stdcell ./sdc]

# 标准单元库
set target_library "saed32nm_tt_1p2v_25c.db"
set link_library [list "*" $target_library]

# ============================================================================
# 3. 读取设计
# ============================================================================

read_file -format verilog ./rtl/l3_cache_top.sv
current_design l3_cache_top

# ============================================================================
# 4. 时序约束
# ============================================================================

source ./sdc/l3_cache.sdc

# ============================================================================
# 5. 约束设计
# ============================================================================

# 设置驱动单元
set_drive 0 [get_ports clk]
set_drive 0 [get_ports rst_n]

# 设置输入负载
set_load -pin_load 0.02 [get_ports clk]
set_load -pin_load 0.02 [get_ports rst_n]

# ============================================================================
# 6. 编译
# ============================================================================

compile_ultra -gate_clock -no_boundary_optimization

# ============================================================================
# 7. 报告
# ============================================================================

report_timing -delay max -max_paths 50 > ./reports/timing_report.txt
report_area > ./reports/area_report.txt
report_power > ./reports/power_report.txt
report_qor > ./reports/qor_report.txt

# ============================================================================
# 8. 输出网表
# ============================================================================

write -format ddc -output ./outputs/l3_cache.ddc
write -format verilog -output ./outputs/l3_cache_netlist.v
write_sdc ./outputs/l3_cache.sdc
