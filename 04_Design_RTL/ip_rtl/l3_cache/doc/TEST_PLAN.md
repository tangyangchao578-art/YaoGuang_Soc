# L3 Cache测试计划

**文档编号**: L3C-TEST-001  
**版本**: V1.0  
**日期**: 2026-01-18  
**状态**: 已批准

---

## 1. 概述

### 1.1 测试目标

L3 Cache模块的测试目标是验证以下功能正确性：

- 读/写操作正确性
- Cache命中/未命中处理
- 一致性协议
- 替换策略
- 带宽和延迟性能

### 1.2 测试范围

| 测试类型 | 范围 |
|---------|------|
| 功能测试 | 所有功能点 |
| 性能测试 | 带宽/延迟 |
| 压力测试 | 边界条件 |
| 异常测试 | 错误处理 |

---

## 2. 测试环境

### 2.1 硬件环境

| 组件 | 配置 |
|------|------|
| 仿真器 | VCS Xcelium |
| 仿真模式 | RTL + Gate |
| 编译选项 | -debug -ntb_opts uvm |

### 2.2 软件环境

| 组件 | 版本 |
|------|------|
| UVM | 1.2 |
| SystemVerilog | IEEE 1800-2017 |
| Perl | 5.30+ |

---

## 3. 测试用例

### 3.1 基本功能测试

| 用例编号 | 用例名称 | 描述 | 预期结果 |
|---------|---------|------|---------|
| TC001 | 单次读 | 单一读请求 | 正确返回数据 |
| TC002 | 单次写 | 单一写请求 | 数据写入Cache |
| TC003 | 读后写 | 读后写同一地址 | 正确更新数据 |
| TC004 | 写后读 | 写后读同一地址 | 返回写入数据 |
| TC005 | 突发读 | 16-beat读突发 | 正确返回所有数据 |
| TC006 | 突发写 | 16-beat写突发 | 所有数据写入 |

### 3.2 Cache操作测试

| 用例编号 | 用例名称 | 描述 | 预期结果 |
|---------|---------|------|---------|
| TC010 | 读命中 | 重复读同一地址 | 命中，延迟降低 |
| TC011 | 写命中 | 重复写同一地址 | 命中，数据更新 |
| TC012 | 读未命中 | 读新地址 | 未命中，从内存加载 |
| TC013 | 写未命中 | 写新地址 | 未命中，分配行 |
| TC014 | 替换 | 填满后继续访问 | 触发替换 |
| TC015 | 写回 | 脏行被替换 | 写回内存 |

### 3.3 一致性测试

| 用例编号 | 用例名称 | 描述 | 预期结果 |
|---------|---------|------|---------|
| TC020 | 多Master读 | 多Master同时读 | 数据一致 |
| TC021 | 多Master写 | 多Master写不同行 | 数据正确 |
| TC022 | 写冲突 | 两Master写同地址 | 一致性维护 |
| TC023 | Snoop命中 | 某行被Snoop | 正确响应 |

### 3.4 压力测试

| 用例编号 | 用例名称 | 描述 | 预期结果 |
|---------|---------|------|---------|
| TC030 | 满负载 | 所有Master同时访问 | 无死锁 |
| TC031 | 随机访问 | 随机地址访问 | 正常工作 |
| TC032 | 长时间运行 | 10M次操作 | 无错误 |
| TC033 | 边界访问 | 地址边界测试 | 正确处理 |

### 3.5 异常测试

| 用例编号 | 用例名称 | 描述 | 预期结果 |
|---------|---------|------|---------|
| TC040 | 地址对齐 | 非对齐访问 | 正确响应 |
| TC041 | 突发长度 | 非法突发长度 | 错误响应 |
| TC042 | 超时 | 内存访问超时 | 错误上报 |
| TC043 | ECC错误 | 注入ECC错误 | 错误检测 |

---

## 4. 性能测试

### 4.1 延迟测试

| 测试项 | 目标值 | 测试方法 |
|-------|-------|---------|
| 读命中延迟 | ≤ 10 cycles | 测量AR到RVALID |
| 写命中延迟 | ≤ 10 cycles | 测量AW到BVALID |
| 读未命中延迟 | ≤ 50 cycles | 测量AR到RVALID (miss) |
| 刷新时间 | ≤ 100K cycles | 完整刷新时间 |

### 4.2 带宽测试

| 测试项 | 目标值 | 测试方法 |
|-------|-------|---------|
| 峰值读带宽 | ≥ 500 GB/s | 16 Master满负载 |
| 峰值写带宽 | ≥ 500 GB/s | 16 Master满负载 |
| 持续带宽 | ≥ 400 GB/s | 长时间测试 |

---

## 5. 覆盖率目标

### 5.1 代码覆盖率

| 覆盖率类型 | 目标 |
|-----------|------|
| 行覆盖率 | ≥ 95% |
| 分支覆盖率 | ≥ 95% |
| 条件覆盖率 | ≥ 90% |
| 翻转覆盖率 | ≥ 90% |
| FSM覆盖率 | ≥ 100% |

### 5.2 功能覆盖率

| 覆盖率点 | 描述 | 目标 |
|---------|------|------|
| 读/写比例 | 读写操作分布 | 60/40 |
| 地址分布 | 地址空间覆盖 | 全范围 |
| 突发类型 | INCR/WRAP/FIXED | 全部 |
| Master分布 | 16 Master使用 | 全部 |

---

## 6. 测试进度

### 6.1 开发计划

| 阶段 | 任务 | 开始 | 结束 | 状态 |
|------|------|------|------|------|
| 环境搭建 | UVM环境开发 | W1 | W2 | 待开始 |
| 基本测试 | TC001-TC006 | W3 | W4 | 待开始 |
| Cache测试 | TC010-TC015 | W5 | W6 | 待开始 |
| 一致性测试 | TC020-TC023 | W7 | W8 | 待开始 |
| 压力测试 | TC030-TC033 | W9 | W10 | 待开始 |
| 性能测试 | 带宽/延迟测试 | W11 | W12 | 待开始 |
| 异常测试 | TC040-TC043 | W13 | W14 | 待开始 |
| 回归测试 | 全测试回归 | W15 | W16 | 待开始 |

---

## 7. 签核标准

### 7.1 功能签核

- [ ] 所有测试用例通过
- [ ] 代码覆盖率达标
- [ ] 功能覆盖率达标
- [ ] 无严重缺陷
- [ ] 回归测试通过

### 7.2 性能签核

- [ ] 延迟满足目标
- [ ] 带宽满足目标
- [ ] 功耗满足目标
- [ ] 面积满足目标

---

## 8. 风险评估

| 风险 | 影响 | 概率 | 缓解措施 |
|------|------|------|---------|
| 验证不充分 | 高 | 低 | 增加测试用例 |
| 性能不达标 | 中 | 中 | 优化设计 |
| 一致性问题 | 高 | 中 | 形式验证 |

---

**文档版本**: V1.0  
**最后更新**: 2026-01-18
