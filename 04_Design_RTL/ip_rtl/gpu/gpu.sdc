#==============================================================================
#  GPU SDC Constraint File - YaoGuang SoC
#==============================================================================
#  File: gpu.sdc
#  Description: GPU 时序约束文件
#==============================================================================

#==============================================================================
#  时钟定义
#==============================================================================
create_clock -period 0.667 [get_ports clk_i]
set_clock_uncertainty -setup 0.05 [get_clocks clk_i]
set_clock_uncertainty -hold 0.025 [get_clocks clk_i]

#==============================================================================
#  IO 延迟约束
#==============================================================================
set_input_delay -clock clk_i -max 0.2 [get_ports ace_*]
set_output_delay -clock clk_i -max 0.2 [get_ports ace_*]
set_input_delay -clock clk_i -max 0.15 [get_ports irq_*]
set_output_delay -clock clk_i -max 0.15 [get_ports irq_*]
set_input_delay -clock clk_i -max 0.1 [get_ports reg_*]
set_output_delay -clock clk_i -max 0.1 [get_ports reg_*]

#==============================================================================
#  IO 驱动约束
#==============================================================================
set_driving_cell -lib_cell INV_X4 [get_ports clk_i]
set_driving_cell -lib_cell DFF_X2 [get_ports rst_n_i]
set_load -pin_load 0.05 [get_ports ace_*]
set_load -pin_load 0.03 [get_ports irq_*]

#==============================================================================
#  最大延迟约束
#==============================================================================
set_max_delay -from [get_ports clk_i] -to [all_outputs] 0.5
set_max_delay -from [all_inputs] -to [get_ports clk_i] 0.5

#==============================================================================
#  伪路径约束
#==============================================================================
set_false_path -from [get_ports rst_n_i]
set_false_path -from irq_*_i -to irq_*_o

#==============================================================================
#  多周期约束
#==============================================================================
set_multicycle_path -setup -end 2 -from [get_pins */u_shader_core*/clk_i] -to [get_pins */u_l2_cache*/clk_i]
set_multicycle_path -hold -end 1 -from [get_pins */u_shader_core*/clk_i] -to [get_pins */u_l2_cache*/clk_i]

#==============================================================================
#  时序分组
#==============================================================================
setTimingMode -analysisType single
setAnalysisMode -setup
setAnalysisMode -hold

#==============================================================================
#  时钟门控约束
#==============================================================================
set_clock_gating_check -setup 0.1
set_clock_gating_check -hold 0.05

#==============================================================================
#  面积约束
#==============================================================================
set_max_area 8000000

#==============================================================================
#  功耗约束
#==============================================================================
set_power_optimization -sequential true
set_max_dynamic_power 7

#==============================================================================
#  寄存器重命名
#==============================================================================
set_register_renaming -enabled true

#==============================================================================
#  线负载模型
#==============================================================================
set_wire_load_mode top
set_wire_load_model -name 4000

#==============================================================================
#  设计约束检查
#==============================================================================
check_design
report_constraint -all_violators
