# 摇光(YaoGuang) SoC 危害分析与风险评估报告 (HARA)

> **文档版本**: V1.0  
> **编制日期**: 2026-01-18  
> **状态**: 初稿  
> **适用标准**: ISO 26262:2018  
> **安全等级**: ASIL-D

---

## 文档信息

| 项目 | 内容 |
|------|------|
| 文档编号 | YG-FUSA-HARA-001 |
| 项目名称 | 摇光自动驾驶SoC |
| 安全等级目标 | ASIL-D |
| 编制人 | 功能安全专家 |
| 审核人 | 待定 |
| 批准人 | 待定 |

---

## 修订历史

| 版本 | 日期 | 修订人 | 修订内容 |
|------|------|--------|----------|
| V1.0 | 2026-01-18 | FuSa | 初稿 |

---

## 目录

1. [概述](#1-概述)
2. [相关项定义](#2-相关项定义)
3. [危害识别](#3-危害识别)
4. [风险评估](#4-风险评估)
5. [安全目标定义](#5-安全目标定义)
6. [安全要求分配](#6-安全要求分配)
7. [结论与后续工作](#7-结论与后续工作)

---

## 1. 概述

### 1.1 目的

本文档是摇光(YaoGuang) SoC车规级自动驾驶芯片的**危害分析与风险评估(HARA)**报告。根据ISO 26262标准要求，HARA是功能安全生命周期的起点，旨在：

- 识别芯片可能导致的车辆级危害
- 评估每个危害的严重度(S)、暴露率(E)和可控性(C)
- 确定每个危害的ASIL安全等级
- 导出安全目标，为后续安全设计提供依据

### 1.2 范围

本HARA分析覆盖摇光SoC的所有安全相关功能：

| 功能域 | 子功能 | 安全相关性 |
|--------|--------|-----------|
| **计算处理** | CPU集群 (Cortex-A78AE ×4) | 高 |
| **AI推理** | NPU集群 (300+ TOPS) | 高 |
| **图形处理** | GPU (Mali-G78) | 中 |
| **安全岛** | 双核锁步 (Cortex-R52 ×2) | 极高 |
| **图像处理** | ISP (16路摄像头) | 高 |
| **通信接口** | PCIe, Ethernet, USB | 中 |
| **存储控制** | DDR5/LPDDR5控制器 | 高 |
| **电源管理** | PMU, 监控器 | 高 |

### 1.3 参考标准

| 标准 | 内容 |
|------|------|
| ISO 26262:2018 | 道路车辆功能安全 |
| ISO 21448:2022 | 预期功能安全 (SOTIF) |
| SAE J3016 | 自动驾驶分级标准 |
| UN R157 | 高速公路自动驾驶法规 |

### 1.4 术语定义

| 术语 | 定义 |
|------|------|
| **危害 (Hazard)** | 相关项故障可能导致的身体伤害或健康损害的潜在来源 |
| **危害事件 (Hazardous Event)** | 危害与暴露场景的组合 |
| **严重度 (Severity)** | 危害事件可能造成伤害的严重程度 |
| **暴露率 (Exposure)** | 车辆处于可能触发危害的场景的概率 |
| **可控性 (Controllability)** | 驾驶者或其他道路交通参与者避免伤害的难易程度 |
| **ASIL** | 汽车安全完整性等级 (A, B, C, D) |
| **FTTI** | 故障容错时间间隔 (Fault Tolerant Time Interval) |
| **安全目标** | 为防止或充分缓解危害事件而设定的顶层安全要求 |

---

## 2. 相关项定义

### 2.1 系统概述

摇光SoC是面向L4级自动驾驶域控制器的车规级AI芯片，主要功能：

```
┌─────────────────────────────────────────────────────────────────┐
│                    摇光 SoC 系统架构                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│   ┌─────────────┐     ┌─────────────┐     ┌─────────────┐       │
│   │  摄像头输入  │     │  雷达/激光  │     │   V2X通信   │       │
│   │  (16路)     │     │   数据      │     │             │       │
│   └──────┬──────┘     └──────┬──────┘     └──────┬──────┘       │
│          │                   │                   │              │
│          └───────────────────┼───────────────────┘              │
│                              │                                  │
│                    ┌─────────▼─────────┐                        │
│                    │       ISP         │                        │
│                    │   图像预处理      │                        │
│                    └─────────┬─────────┘                        │
│                              │                                  │
│                    ┌─────────▼─────────┐                        │
│                    │     NPU 集群      │                        │
│                    │   300+ TOPS AI    │                        │
│                    │   (4× Cluster)    │                        │
│                    └─────────┬─────────┘                        │
│                              │                                  │
│          ┌───────────────────┼───────────────────┐              │
│          │                   │                   │              │
│   ┌──────▼──────┐     ┌──────▼──────┐     ┌──────▼──────┐       │
│   │  CPU 集群   │     │    GPU      │     │  Safety     │       │
│   │  (A78AE×4)  │     │  (G78)      │     │  Island     │       │
│   │  通用计算   │     │  图形渲染   │     │  (R52×2 LS) │       │
│   └─────────────┘     └─────────────┘     └─────────────┘       │
│                              │                                  │
│                    ┌─────────▼─────────┐                        │
│                    │      NoC          │                        │
│                    │   片上网络        │                        │
│                    └─────────┬─────────┘                        │
│                              │                                  │
│          ┌───────────────────┼───────────────────┐              │
│          │                   │                   │              │
│   ┌──────▼──────┐     ┌──────▼──────┐     ┌──────▼──────┐       │
│   │  DDR5/LPDDR │     │   PCIe     │     │  10G Ethernet│      │
│   │  存储控制   │     │  Gen4 ×8   │     │             │       │
│   └─────────────┘     └─────────────┘     └─────────────┘       │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 2.2 功能描述

#### 2.2.1 核心处理功能

| 功能 | 描述 | 性能指标 |
|------|------|----------|
| **AI感知** | 神经网络推理，目标检测/分类/跟踪 | 300+ TOPS (INT8) |
| **路径规划** | 行为决策，路径生成 | 2 GHz ×4 A78AE |
| **传感器融合** | 多传感器数据融合 | 16路摄像头输入 |
| **地图定位** | 高精地图匹配，SLAM | 200 GB/s 带宽 |

#### 2.2.2 安全关键功能

| 功能 | 描述 | 安全等级 |
|------|------|----------|
| **安全岛监控** | 系统安全监控，故障检测 | ASIL-D |
| **安全输出** | 安全决策输出，控制指令 | ASIL-D |
| **看门狗** | 系统监控，故障响应 | ASIL-D |
| **故障隔离** | 故障检测和隔离 | ASIL-D |

### 2.3 运行环境

| 参数 | 范围 |
|------|------|
| **工作温度** | -40°C ~ +125°C (Grade 1) |
| **工作电压** | 0.75V (Core), 0.9V (IO) |
| **寿命** | 15年 / 30,000小时 |
| **适用车型** | 乘用车 (最大3.5吨) |
| **自动驾驶等级** | L3-L4 |

### 2.4 相关项边界

```
┌─────────────────────────────────────────────────────────────┐
│                    相关项边界                               │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   输入边界:                    输出边界:                     │
│   • 摄像头数据                 • 车辆控制指令               │
│   • 雷达数据                   • 转向控制                   │
│   • 激光雷达数据               • 制动控制                   │
│   • V2X通信                    • 加速控制                   │
│   • 高精地图                   • 报警信号                   │
│   • 车辆状态                   • 诊断信息                   │
│                                                             │
│   边界外(不分析):                                         │
│   • 摄像头模组(光学部分)                                   │
│   • 执行器(转向机/制动系统)                                │
│   • 外部通信网络                                          │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 3. 危害识别

### 3.1 危害识别方法

危害识别采用以下方法的组合：

| 方法 | 描述 | 应用范围 |
|------|------|----------|
| **头脑风暴** | 专家团队讨论可能的危害场景 | 初始危害识别 |
| **FTA分析** | 故障树分析，识别导致危害的基本事件 | 深入分析 |
| **HAZOP** | 引导词分析，识别偏差导致的危害 | 功能分析 |
| **经验法** | 参考类似系统的事故和故障数据 | 补充验证 |

### 3.2 功能故障识别

#### 3.2.1 处理单元故障

| 功能单元 | 可能的故障模式 | 故障影响 |
|----------|---------------|----------|
| **CPU集群** | 计算错误、数据损坏、死锁 | 决策错误、控制失效 |
| **NPU集群** | 推理错误、输出异常、延迟 | 感知错误、误检/漏检 |
| **GPU** | 渲染错误、显示异常 | HMI显示错误 |
| **Safety Island** | 锁步不匹配、监控失效 | 安全机制失效 |

#### 3.2.2 存储系统故障

| 功能单元 | 可能的故障模式 | 故障影响 |
|----------|---------------|----------|
| **DDR控制器** | 数据错误、时序错误 | 数据损坏、访问失败 |
| **Cache** | ECC错误、数据不一致 | 缓存数据损坏 |
| **L3 Cache** | 访问错误、一致性错误 | 系统数据错误 |

#### 3.2.3 通信接口故障

| 功能单元 | 可能的故障模式 | 故障影响 |
|----------|---------------|----------|
| **PCIe** | 数据错误、链路丢失 | 通信中断 |
| **Ethernet** | 数据错误、超时 | V2X通信失败 |
| **USB** | 数据错误、枚举失败 | 诊断接口失效 |

#### 3.2.4 电源/时钟故障

| 功能单元 | 可能的故障模式 | 故障影响 |
|----------|---------------|----------|
| **PMU** | 电压异常、复位异常 | 系统不稳定 |
| **时钟** | 频率偏移、停振 | 时序错误、系统失效 |

### 3.3 车辆级危害识别

根据识别的功能故障，分析可能的车辆级危害：

#### 3.3.1 感知系统危害

| 危害编号 | 危害描述 | 触发场景 |
|----------|----------|----------|
| H-001 | 目标漏检 | 车辆/行人/障碍物未被检测到 |
| H-002 | 目标误检 | 将无害物体误判为障碍物 |
| H-003 | 目标分类错误 | 误判车辆类型或状态 |
| H-004 | 距离估计错误 | 距离判断失误 |
| H-005 | 速度估计错误 | 相对速度判断失误 |

#### 3.3.2 决策系统危害

| 危害编号 | 危害描述 | 触发场景 |
|----------|----------|----------|
| H-006 | 错误换道决策 | 不当的换道指令 |
| H-007 | 错误转弯决策 | 不当的转弯指令 |
| H-008 | 错误跟车决策 | 不当的跟车距离/速度 |
| H-009 | 错误紧急制动决策 | 不必要的紧急制动 |
| H-010 | 决策延迟 | 处理时间过长 |

#### 3.3.3 执行系统危害

| 危害编号 | 危害描述 | 触发场景 |
|----------|----------|----------|
| H-011 | 转向控制错误 | 错误的转向角度 |
| H-012 | 制动控制错误 | 错误的制动力度 |
| H-013 | 加速控制错误 | 错误的加速请求 |
| H-014 | 控制失效 | 完全失去控制能力 |

#### 3.3.4 通信系统危害

| 危害编号 | 危害描述 | 触发场景 |
|----------|----------|----------|
| H-015 | V2X通信中断 | 失去车联网通信 |
| H-016 | 诊断信息错误 | 错误的状态报告 |

#### 3.3.5 状态监控系统危害

| 危害编号 | 危害描述 | 触发场景 |
|----------|----------|----------|
| H-017 | 安全岛失效 | 无法检测系统故障 |
| H-018 | 看门狗失效 | 无法恢复系统错误 |
| H-019 | 错误的安全状态转换 | 不当的安全状态 |

---

## 4. 风险评估

### 4.1 评估参数定义

#### 4.1.1 严重度 (S) 评估

| 等级 | 描述 | 定义 | 典型伤害 |
|------|------|------|----------|
| **S0** | 无伤害 | 无伤害 | 无 |
| **S1** | 轻微伤害 | 轻微伤害，无需医疗干预 | 挫伤、轻微擦伤 |
| **S2** | 中等伤害 | 需要医疗干预的中度伤害 | 骨折、撕裂伤 |
| **S3** | 严重伤害 | 危及生命或造成严重伤害 | 重伤、可能致死 |
| **S3\*** | 危及生命 | 可能导致死亡的严重伤害 | 致命伤 |

#### 4.1.2 暴露率 (E) 评估

| 等级 | 描述 | 定义 | 典型概率 |
|------|------|------|----------|
| **E0** | 不可能 | 不可能发生 | < 10⁻⁹/h |
| **E1** | 极低概率 | 罕见场景 | 10⁻⁹ ~ 10⁻⁷/h |
| **E2** | 低概率 | 低频率场景 | 10⁻⁷ ~ 10⁻⁵/h |
| **E3** | 中等概率 | 中等频率场景 | 10⁻⁵ ~ 10⁻³/h |
| **E4** | 高概率 | 高频率场景 | > 10⁻³/h |

#### 4.1.3 可控性 (C) 评估

| 等级 | 描述 | 定义 | 典型可控性 |
|------|------|------|------------|
| **C1** | 简单可控 | 驾驶者可轻松控制 | > 99% 可控 |
| **C2** | 正常可控 | 驾驶者通常能控制 | > 90% 可控 |
| **C3** | 难以控制 | 需要努力控制 | > 60% 可控 |
| **C4** | 不可控 | 驾驶者无法控制 | < 60% 可控 |

### 4.2 ASIL等级确定矩阵

| 严重度 | 暴露率 | C1 | C2 | C3 | C4 |
|--------|--------|----|----|----|-----|
| **S1** | E1 | QM | QM | QM | QM |
| | E2 | QM | QM | QM | QM |
| | E3 | QM | QM | QM | ASIL A |
| | E4 | QM | QM | ASIL A | ASIL B |
| **S2** | E1 | QM | QM | QM | QM |
| | E2 | QM | QM | ASIL A | ASIL B |
| | E3 | QM | ASIL A | ASIL B | ASIL C |
| | E4 | ASIL A | ASIL B | ASIL C | ASIL D |
| **S3** | E1 | QM | QM | ASIL A | ASIL B |
| | E2 | QM | ASIL A | ASIL B | ASIL C |
| | E3 | ASIL A | ASIL B | ASIL C | ASIL D |
| | E4 | ASIL B | ASIL C | ASIL D | **ASIL D+** |
| **S3\*** | E1 | QM | ASIL A | ASIL B | ASIL C |
| | E2 | ASIL A | ASIL B | ASIL C | ASIL D |
| | E3 | ASIL B | ASIL C | ASIL D | **ASIL D+** |
| | E4 | ASIL C | ASIL D | **ASIL D+** | **ASIL D+** |

> **注**: 对于S3\* + E4 + C4的组合，需要ASIL D+级别，实施额外安全措施

### 4.3 详细风险评估

#### 4.3.1 感知系统危害评估

| 危害ID | 危害描述 | S | E | C | ASIL | FTTI |
|--------|----------|---|----|---|-----|------|
| H-001 | 目标漏检 - 车辆 | S3 | E4 | C3 | **ASIL D** | 100ms |
| H-001a | 目标漏检 - 行人 | S3\* | E4 | C2 | **ASIL D+** | 50ms |
| H-001b | 目标漏检 - 障碍物 | S3 | E3 | C3 | **ASIL D** | 100ms |
| H-002 | 目标误检 - 误刹车 | S2 | E4 | C2 | **ASIL B** | 200ms |
| H-003 | 目标分类错误 | S3 | E3 | C3 | **ASIL D** | 100ms |
| H-004 | 距离估计错误 | S3 | E4 | C3 | **ASIL D** | 100ms |
| H-005 | 速度估计错误 | S3 | E4 | C3 | **ASIL D** | 100ms |

**分析说明**:
- 行人漏检(S3\*)：行人被漏检可能导致致命事故，且行人是弱势道路使用者，不可控性高(E4+C2)
- 车辆漏检(S3)：车辆被漏检可能导致严重碰撞，但驾驶员有一定可控性

#### 4.3.2 决策系统危害评估

| 危害ID | 危害描述 | S | E | C | ASIL | FTTI |
|--------|----------|---|----|---|-----|------|
| H-006 | 错误换道决策 | S3 | E3 | C3 | **ASIL D** | 200ms |
| H-007 | 错误转弯决策 | S3 | E2 | C3 | **ASIL C** | 200ms |
| H-008 | 错误跟车决策 | S2 | E4 | C2 | **ASIL B** | 300ms |
| H-009 | 错误紧急制动决策 | S2 | E4 | C2 | **ASIL B** | 100ms |
| H-010 | 决策延迟 | S3 | E3 | C3 | **ASIL D** | 50ms |

**分析说明**:
- 错误换道(S3+E3+C3)：可能导致与相邻车道车辆碰撞
- 决策延迟(S3+E3+C3)：在紧急情况下可能导致碰撞

#### 4.3.3 执行系统危害评估

| 危害ID | 危害描述 | S | E | C | ASIL | FTTI |
|--------|----------|---|----|---|-----|------|
| H-011 | 转向控制错误 | S3 | E3 | C2 | **ASIL D** | 50ms |
| H-012 | 制动控制错误 | S3\* | E3 | C2 | **ASIL D+** | 20ms |
| H-013 | 加速控制错误 | S3 | E3 | C2 | **ASIL D** | 50ms |
| H-014 | 控制失效 | S3\* | E3 | C4 | **ASIL D+** | 10ms |

**分析说明**:
- 制动控制错误(S3\*+E3+C2)：错误的紧急制动可能导致追尾
- 控制失效(S3\*+E3+C4)：完全失控可能导致多车连撞

#### 4.3.4 通信系统危害评估

| 危害ID | 危害描述 | S | E | C | ASIL | FTTI |
|--------|----------|---|----|---|-----|------|
| H-015 | V2X通信中断 | S2 | E2 | C2 | **ASIL A** | 500ms |
| H-016 | 诊断信息错误 | S1 | E4 | C1 | **QM** | N/A |

#### 4.3.5 状态监控系统危害评估

| 危害ID | 危害描述 | S | E | C | ASIL | FTTI |
|--------|----------|---|----|---|-----|------|
| H-017 | 安全岛失效 | S3\* | E4 | C4 | **ASIL D+** | 5ms |
| H-018 | 看门狗失效 | S3 | E3 | C3 | **ASIL D** | 10ms |
| H-019 | 错误安全状态转换 | S2 | E3 | C2 | **ASIL B** | 50ms |

### 4.4 风险评估汇总

#### 4.4.1 按ASIL等级分类

| ASIL等级 | 危害数量 | 主要危害 |
|----------|----------|----------|
| **ASIL D+** | 4 | H-001a, H-012, H-014, H-017 |
| **ASIL D** | 10 | H-001, H-003, H-004, H-005, H-006, H-010, H-011, H-013 |
| **ASIL C** | 1 | H-007 |
| **ASIL B** | 4 | H-002, H-008, H-009, H-019 |
| **ASIL A** | 1 | H-015 |
| **QM** | 1 | H-016 |

#### 4.4.2 按功能域分类

| 功能域 | ASIL D+ | ASIL D | ASIL C | ASIL B | ASIL A |
|--------|---------|--------|--------|--------|--------|
| 感知系统 | 1 | 5 | 0 | 0 | 0 |
| 决策系统 | 0 | 3 | 1 | 2 | 0 |
| 执行系统 | 2 | 2 | 0 | 0 | 0 |
| 通信系统 | 0 | 0 | 0 | 0 | 1 |
| 监控系统 | 1 | 0 | 0 | 1 | 0 |
| **总计** | **4** | **10** | **1** | **4** | **1** |

#### 4.4.3 FTTI汇总

| FTTI范围 | 危害数量 | 百分比 |
|----------|----------|--------|
| < 10ms | 1 | 5% |
| 10-50ms | 3 | 15% |
| 50-100ms | 8 | 40% |
| 100-200ms | 4 | 20% |
| 200-500ms | 3 | 15% |
| > 500ms | 1 | 5% |

---

## 5. 安全目标定义

### 5.1 安全目标导出

根据危害评估结果，导出以下安全目标：

#### 5.1.1 顶级安全目标

| 安全目标ID | 安全目标 | 对应危害 | ASIL | FTTI |
|------------|----------|----------|------|------|
| **SG-01** | 系统必须检测并响应所有感知错误，防止目标漏检 | H-001, H-001a, H-001b | ASIL D+ | 50ms |
| **SG-02** | 系统必须确保决策输出的正确性和及时性 | H-006, H-007, H-010 | ASIL D | 100ms |
| **SG-03** | 系统必须确保执行控制的正确性和安全性 | H-011, H-012, H-013, H-014 | ASIL D+ | 20ms |
| **SG-04** | 系统必须持续监控自身状态，并在故障时进入安全状态 | H-017, H-018, H-019 | ASIL D+ | 10ms |
| **SG-05** | 系统必须确保V2X通信的可靠性 | H-015 | ASIL A | 500ms |

### 5.2 安全目标详细定义

#### SG-01: 感知安全目标

```
安全目标: SG-01 - 感知系统安全

目标: 系统必须检测并响应所有感知错误，防止目标漏检

要求:
  SG-01.1: NPU推理输出必须经过校验，检测单比特错误
  SG-01.2: 感知结果必须与Safety Island进行交叉验证
  SG-01.3: 当检测到感知异常时，系统必须在50ms内进入安全状态
  SG-01.4: 传感器数据流必须进行CRC校验
  SG-01.5: 摄像头输入帧必须进行完整性检查

安全机制:
  • 双路NPU推理结果比较
  • ECC保护(数据/权重)
  • 帧完整性校验
  • 传感器数据冗余校验
  • Safety Island独立验证

诊断覆盖率目标: ≥ 99%
```

#### SG-02: 决策安全目标

```
安全目标: SG-02 - 决策系统安全

目标: 系统必须确保决策输出的正确性和及时性

要求:
  SG-02.1: CPU集群计算结果必须经过验证
  SG-02.2: 决策逻辑必须具有时间监控，防止死循环
  SG-02.3: 决策输出必须在100ms内完成
  SG-02.4: 关键决策必须经过Safety Island确认
  SG-02.5: 决策超时必须在FTTI内检测并处理

安全机制:
  • CPU锁步校验
  • 决策超时看门狗
  • Safety Island决策确认
  • 决策结果合理性检查
  • 双核计算结果比较

诊断覆盖率目标: ≥ 99%
```

#### SG-03: 执行安全目标

```
安全目标: SG-03 - 执行系统安全

目标: 系统必须确保执行控制的正确性和安全性

要求:
  SG-03.1: 控制输出必须经过Safety Island验证
  SG-03.2: 控制指令必须具有有效性检查
  SG-03.3: 控制输出必须在20ms内完成
  SG-03.4: 异常控制输出必须在FTTI内禁止
  SG-03.5: 看门狗必须监控执行器响应

安全机制:
  • 输出指令双路验证
  • 执行器响应反馈监控
  • 紧急制动保护机制
  • 转向角度范围检查
  • Safety Island输出使能

诊断覆盖率目标: ≥ 99.9%
```

#### SG-04: 监控安全目标

```
安全目标: SG-04 - 监控系统安全

目标: 系统必须持续监控自身状态，并在故障时进入安全状态

要求:
  SG-04.1: Safety Island必须具有独立的电源和时钟
  SG-04.2: Safety Island必须持续监控主系统状态
  SG-04.3: 看门狗必须在10ms内检测系统失效
  SG-04.4: 系统必须在看门狗超时后进入安全状态
  SG-04.5: 安全状态转换必须可靠且可预测

安全机制:
  • 双核锁步Cortex-R52
  • 独立窗口看门狗
  • 电压/温度/时钟监控
  • 独立复位控制器
  • 故障注入自检

诊断覆盖率目标: ≥ 99.9%
```

#### SG-05: 通信安全目标

```
安全目标: SG-05 - 通信系统安全

目标: 系统必须确保V2X通信的可靠性

要求:
  SG-05.1: 通信数据必须进行完整性校验
  SG-05.2: 通信中断必须在500ms内检测
  SG-05.3: 通信错误必须通知主系统

安全机制:
  • CRC校验
  • 通信超时监控
  • 消息序列号检查

诊断覆盖率目标: ≥ 90%
```

### 5.3 安全目标关系

```
┌─────────────────────────────────────────────────────────────────┐
│                    安全目标层次关系                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│                    ┌───────────────────┐                        │
│                    │    安全目标总览    │                        │
│                    │   SG-01 ~ SG-05   │                        │
│                    └─────────┬─────────┘                        │
│                              │                                  │
│         ┌────────────────────┼────────────────────┐             │
│         │                    │                    │             │
│    ┌────▼────┐         ┌────▼────┐         ┌────▼────┐         │
│    │感知安全 │         │决策安全 │         │执行安全 │         │
│    │ SG-01   │         │ SG-02   │         │ SG-03   │         │
│    │ ASIL D+ │         │ ASIL D  │         │ ASIL D+ │         │
│    └────┬────┘         └────┬────┘         └────┬────┘         │
│         │                   │                   │             │
│    ┌────▼────────────────────▼────────────────────▼────┐       │
│    │               Safety Island                       │       │
│    │              监控安全 (SG-04)                     │       │
│    │               ASIL D+                            │       │
│    └──────────────────────────────────────────────────┘       │
│                              │                                  │
│                              ▼                                  │
│                    ┌───────────────────┐                        │
│                    │    通信安全        │                        │
│                    │    SG-05          │                        │
│                    │   ASIL A          │                        │
│                    └───────────────────┘                        │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 6. 安全要求分配

### 6.1 安全要求分解

#### 6.1.1 Safety Island 安全要求

```
Safety Island是摇光SoC的核心安全机制，负责：
  1. 持续监控主系统状态
  2. 检测主系统故障
  3. 触发安全状态转换
  4. 执行故障恢复

分配的安全目标:
  • SG-04 (监控系统) - 100%
  • SG-01 (感知) - 50%
  • SG-02 (决策) - 50%
  • SG-03 (执行) - 50%
```

#### 6.1.2 NPU 安全要求

```
NPU负责AI推理计算，需要满足：
  • 推理结果校验
  • 数据/权重ECC保护
  • 推理超时监控

分配的安全目标:
  • SG-01 (感知) - 100%
```

#### 6.1.3 CPU 安全要求

```
CPU负责决策逻辑计算，需要满足：
  • 计算结果校验
  • 决策超时监控
  • 锁步比较

分配的安全目标:
  • SG-02 (决策) - 100%
```

#### 6.1.4 存储系统安全要求

```
存储系统包括DDR、Cache，需要满足：
  • ECC保护
  • 错误检测和纠正
  • 数据一致性检查

分配的安全目标:
  • SG-01, SG-02, SG-03 - 全部
```

### 6.2 安全机制分配矩阵

| 安全机制 | SG-01 | SG-02 | SG-03 | SG-04 | SG-05 |
|----------|-------|-------|-------|-------|-------|
| 双核锁步R52 | ● | ● | ● | ● | |
| NPU结果校验 | ● | | | | |
| ECC保护 | ● | ● | ● | ● | |
| 窗口看门狗 | | ● | ● | ● | |
| Safety Island监控 | ● | ● | ● | ● | |
| 输出验证 | | | ● | | |
| 通信CRC | | | | | ● |

---

## 7. 结论与后续工作

### 7.1 HARA结论

| 项目 | 结论 |
|------|------|
| **安全等级目标** | ASIL-D (部分功能需要ASIL D+) |
| **识别危害数量** | 20个危害事件 |
| **最高ASIL等级** | ASIL D+ (4个危害) |
| **最严格FTTI** | 10ms (Safety Island监控) |
| **主要安全目标** | 5个 (SG-01 ~ SG-05) |
| **关键安全机制** | Safety Island双核锁步、ECC、看门狗 |

### 7.2 关键发现

1. **感知系统是最关键的安全域**
   - 行人漏检被评估为ASIL D+，需要最高级别的安全措施
   - NPU推理必须具有多重冗余保护

2. **Safety Island是安全核心**
   - 监控功能(SG-04)被评估为ASIL D+
   - Safety Island必须具有独立的电源、时钟和看门狗

3. **FTTI要求严格**
   - 控制失效检测要求10ms FTTI
   - 需要极快的故障检测和响应机制

4. **架构设计已满足要求**
   - 双核锁步Cortex-R52提供了高诊断覆盖率
   - ECC保护覆盖主要存储系统
   - 独立的PMU提供电压/温度监控

### 7.3 后续工作

| 工作项 | 输入 | 输出 | 计划时间 |
|--------|------|------|----------|
| 功能安全概念(FSC) | HARA报告 | FSC文档 | 2026-02-28 |
| 技术安全概念(TSC) | FSC | TSC文档 | 2026-03-31 |
| 硬件安全要求(HSR) | TSC | HSR文档 | 2026-04-30 |
| FMEA分析 | HARA | FMEA报告 | 2026-05-31 |
| FMEDA分析 | HSR | FMEDA报告 | 2026-06-30 |
| FTA分析 | HARA | FTA报告 | 2026-06-30 |

### 7.4 风险与假设

#### 假设

| 编号 | 假设 | 验证方法 |
|------|------|----------|
| A-001 | L4自动驾驶系统的FTTI要求基于10km/h制动距离 | 系统级分析验证 |
| A-002 | Safety Island具有独立的电源和时钟 | 设计验证 |
| A-003 | 驾驶员可以在紧急情况下接管控制 | 用户研究验证 |

#### 风险

| 编号 | 风险 | 缓解措施 |
|------|------|----------|
| R-001 | ASIL D+要求可能超出设计能力 | 提前进行ASIL分解，引入冗余 |
| R-002 | 50ms FTTI对于复杂感知可能不足 | 优化处理流程，增加预处理 |
| R-003 | 安全机制可能引入额外故障 | 独立验证安全机制本身 |

---

## 附录

### 附录A: 危害评估详细表格

| 危害ID | 危害场景 | S | E | C | ASIL | 安全目标 | FTTI |
|--------|----------|---|----|---|-----|----------|------|
| H-001 | 车辆目标漏检 | S3 | E4 | C3 | D | SG-01 | 100ms |
| H-001a | 行人目标漏检 | S3\* | E4 | C2 | D+ | SG-01 | 50ms |
| H-001b | 障碍物漏检 | S3 | E3 | C3 | D | SG-01 | 100ms |
| H-002 | 误检导致急刹 | S2 | E4 | C2 | B | SG-01 | 200ms |
| H-003 | 分类错误 | S3 | E3 | C3 | D | SG-01 | 100ms |
| H-004 | 距离估计错误 | S3 | E4 | C3 | D | SG-01 | 100ms |
| H-005 | 速度估计错误 | S3 | E4 | C3 | D | SG-01 | 100ms |
| H-006 | 错误换道 | S3 | E3 | C3 | D | SG-02 | 200ms |
| H-007 | 错误转弯 | S3 | E2 | C3 | C | SG-02 | 200ms |
| H-008 | 错误跟车 | S2 | E4 | C2 | B | SG-02 | 300ms |
| H-009 | 错误急刹 | S2 | E4 | C2 | B | SG-02 | 100ms |
| H-010 | 决策延迟 | S3 | E3 | C3 | D | SG-02 | 50ms |
| H-011 | 转向错误 | S3 | E3 | C2 | D | SG-03 | 50ms |
| H-012 | 制动错误 | S3\* | E3 | C2 | D+ | SG-03 | 20ms |
| H-013 | 加速错误 | S3 | E3 | C2 | D | SG-03 | 50ms |
| H-014 | 控制失效 | S3\* | E3 | C4 | D+ | SG-03 | 10ms |
| H-015 | V2X中断 | S2 | E2 | C2 | A | SG-05 | 500ms |
| H-016 | 诊断错误 | S1 | E4 | C1 | QM | - | N/A |
| H-017 | Safety Island失效 | S3\* | E4 | C4 | D+ | SG-04 | 5ms |
| H-018 | 看门狗失效 | S3 | E3 | C3 | D | SG-04 | 10ms |
| H-019 | 错误安全转换 | S2 | E3 | C2 | B | SG-04 | 50ms |

### 附录B: 严重度评估标准

| 等级 | 伤害描述 | AIS评分 | ISS评分 |
|------|----------|---------|---------|
| S0 | 无伤害 | 0 | 0 |
| S1 | 轻微 | 1-2 | 1-8 |
| S2 | 中等 | 3-4 | 9-15 |
| S3 | 严重 | 5-6 | > 15 |
| S3\* | 危及生命 | - | - |

### 附录C: 暴露率评估标准

| 等级 | 场景描述 | 发生频率 | 概率范围 |
|------|----------|----------|----------|
| E0 | 不可能 | - | < 10⁻⁹/h |
| E1 | 极低 | 罕见 | 10⁻⁹ ~ 10⁻⁷/h |
| E2 | 低 | 每年 | 10⁻⁷ ~ 10⁻⁵/h |
| E3 | 中等 | 每月 | 10⁻⁵ ~ 10⁻³/h |
| E4 | 高 | 经常 | > 10⁻³/h |

### 附录D: 可控性评估标准

| 等级 | 描述 | 驾驶者可避免伤害比例 |
|------|------|---------------------|
| C1 | 简单可控 | > 99% |
| C2 | 正常可控 | > 90% |
| C3 | 难以控制 | > 60% |
| C4 | 不可控 | < 60% |

---

## 审批

| 角色 | 姓名 | 签名 | 日期 |
|------|------|------|------|
| 编制 | 功能安全专家 | | 2026-01-18 |
| 审核 | | | |
| 批准 | | | |

---

**文档版本**: V1.0  
**最后更新**: 2026-01-18  
**状态**: 初稿

*本文档根据ISO 26262:2018标准要求编制，是摇光SoC功能安全分析的基础文档。*
