# 摇光(YaoGuang) SoC IP 选型计划

## 文档信息

| 项目 | 内容 |
|------|------|
| 文档版本 | V1.0 |
| 创建日期 | 2026-01-18 |
| 最后更新 | 2026-01-18 |
| 状态 | 草稿 |
| 负责人 | IP 工程师 / 架构师 |
| 关联文档 | 架构规格书 (01_Architecture_Spec_YaoGuang_SoC.md) |

---

## 1. 概述

### 1.1 选型目标
基于摇光 SoC 架构规格，选择满足性能、功耗、面积、成本和安全要求的 IP，确保芯片成功开发并满足市场需求。

### 1.2 选型原则
1. **技术匹配**: IP 功能满足系统需求
2. **性能达标**: 满足性能指标（频率、带宽、延迟）
3. **功耗可控**: 在功耗预算范围内
4. **面积优化**: 面积占比合理
5. **成本合理**: 授权费、版税在预算内
6. **安全合规**: 满足 ASIL-D 安全要求
7. **生态支持**: 工具链、软件生态完善
8. **供应商可靠**: 供应商技术支持和交付能力

### 1.3 选型范围
- CPU IP (应用处理器、安全处理器)
- GPU IP (可选)
- 存储器控制器 IP (DDR/LPDDR)
- 互连 IP (NoC、总线)
- 外设 IP (PCIe、Ethernet、USB、MIPI等)
- 安全 IP (ECC、BIST、监控)
- 基础 IP (PLL、时钟、复位、IO)

---

## 2. IP 需求分析

### 2.1 核心 IP 需求

| IP 类别 | 功能要求 | 性能要求 | 安全等级 | 数量 |
|---------|---------|---------|---------|------|
| **应用 CPU** | 8核，ARMv8.2-A | 2.0 GHz，≥100K DMIPS | ASIL-B | 1 |
| **安全 CPU** | 双核锁步，ARMv8-R | 1.5 GHz，实时性 | ASIL-D | 1 |
| **NPU** | 300 TOPS INT8，4集群 | 75 TOPS/集群 | ASIL-B | 4集群 |
| **GPU** (可选) | 2核，Vulkan/OpenCL | ≥2 TFLOPS FP32 | QM | 1 |
| **内存控制器** | LPDDR5，2x16-bit | 6400 MT/s，200 GB/s | ASIL-B | 1 |
| **NoC** | AXI4/5，512-bit总线 | ≥500 GB/s峰值带宽 | ASIL-B | 1 |
| **PCIe** | Gen4 x8 + x4 | 16 GB/s + 8 GB/s | ASIL-B | 2 |
| **Ethernet** | 1G/10G，TSN支持 | 10 Gbps | ASIL-B | 2 |
| **USB** | USB 3.2 Gen2 | 10 Gbps | ASIL-B | 4-6端口 |
| **MIPI CSI-2** | v2.0，16通道 | 4K @60fps | ASIL-B | 1 |
| **CAN FD** | CAN FD 2.0 | 5 Mbps | ASIL-B | 8-16端口 |

### 2.2 安全 IP 需求

| IP 类别 | 功能要求 | 安全机制 | ASIL等级 |
|---------|---------|---------|---------|
| **ECC 保护** | SECDED，覆盖所有存储器 | 单位纠错，双位检错 | ASIL-D |
| **BIST** | MBIST (SRAM/DRAM)，LBIST | 内置自测试 | ASIL-D |
| **看门狗** | 窗口看门狗，外部看门狗 | 系统监控 | ASIL-D |
| **电压监控** | 过压/欠压检测 | 电源监控 | ASIL-B |
| **时钟监控** | 时钟丢失/频率检测 | 时钟监控 | ASIL-B |
| **温度监控** | 温度传感器 | 热监控 | ASIL-B |

---

## 3. IP 选型方案

### 3.1 CPU IP 选型

#### 方案 A: ARM Cortex-A78AE + Cortex-R52 (推荐)

| 参数 | Cortex-A78AE (应用CPU) | Cortex-R52 (安全CPU) |
|------|----------------------|-------------------|
| **架构** | ARMv8.2-A | ARMv8-R |
| **核心数** | 8核 | 2核锁步 |
| **频率** | 1.5-2.0 GHz | 1.0-1.5 GHz |
| **安全等级** | ASIL-B | ASIL-D |
| **缓存** | L1: 64+64KB，L2: 512KB/核 | TCM: 256KB |
| **虚拟化** | 支持 | 不支持 |
| **优势** | 车规认证，生态成熟 | ASIL-D认证，双核锁步 |
| **供应商** | ARM | ARM |
| **授权模式** | 架构授权 + 版税 | 架构授权 + 版税 |
| **预估成本** | $5-8M (授权) + 版税 | $2-4M (授权) + 版税 |
| **交付时间** | 6-9个月 | 6-9个月 |

#### 方案 B: RISC-V 方案 (备选)

| 参数 | SiFive P670 (应用CPU) | Codasip RISC-V Safety (安全CPU) |
|------|---------------------|-----------------------------|
| **架构** | RISC-V RV64GC | RISC-V RV64IMAFD |
| **核心数** | 8核 | 2核锁步 |
| **频率** | 1.8-2.2 GHz | 1.2-1.6 GHz |
| **安全等级** | ASIL-B (目标) | ASIL-D (目标) |
| **优势** | 开源生态，低成本 | 可定制，低成本 |
| **风险** | 车规认证未完成 | 车规认证未完成 |
| **预估成本** | $2-4M (授权) | $1-3M (授权) |
| **交付时间** | 9-12个月 | 9-12个月 |

**推荐**: 方案 A (ARM)，理由：车规认证成熟，生态完善，降低项目风险。

### 3.2 GPU IP 选型 (可选)

#### 方案 A: ARM Mali-G78 (推荐)

| 参数 | 规格 |
|------|------|
| **核心数** | 2核 |
| **性能** | ≥2 TFLOPS FP32 |
| **API支持** | Vulkan 1.2, OpenCL 3.0 |
| **安全等级** | QM (可集成安全机制) |
| **优势** | ARM生态，与CPU协同优化 |
| **成本** | $1-3M (授权) + 版税 |
| **交付时间** | 6-9个月 |

#### 方案 B: Imagination B-Series (备选)

| 参数 | 规格 |
|------|------|
| **核心数** | 2核 |
| **性能** | ≥2.5 TFLOPS FP32 |
| **API支持** | Vulkan, OpenCL, OpenGL ES |
| **优势** | 高性能，低功耗 |
| **成本** | $2-4M (授权) |
| **交付时间** | 6-9个月 |

**推荐**: 方案 A (Mali-G78)，理由：与ARM CPU生态一致，降低集成难度。

### 3.3 存储器控制器 IP

#### 方案 A: Cadence LPDDR5 Controller (推荐)

| 参数 | 规格 |
|------|------|
| **标准** | LPDDR5/4/4X |
| **数据速率** | 6400 MT/s |
| **接口宽度** | 2x16-bit |
| **带宽** | 200 GB/s |
| **ECC支持** | 内建ECC，SECDED |
| **安全等级** | ASIL-B ready |
| **优势** | 成熟IP，广泛使用 |
| **成本** | $1-2M (授权) |
| **交付时间** | 3-6个月 |

#### 方案 B: Synopsys DesignWare LPDDR5 (备选)

| 参数 | 规格 |
|------|------|
| **标准** | LPDDR5/4 |
| **数据速率** | 6400 MT/s |
| **优势** | 与Synopsys工具链集成好 |
| **成本** | $1.5-2.5M (授权) |
| **交付时间** | 3-6个月 |

**推荐**: 方案 A (Cadence)，理由：性能稳定，车规应用案例多。

### 3.4 NoC IP 选型

#### 方案 A: Arteris FlexNoC (推荐)

| 参数 | 规格 |
|------|------|
| **协议** | AXI4/5, ACE, CHI |
| **位宽** | 支持512-bit |
| **带宽** | ≥500 GB/s |
| **QoS** | 支持服务质量 |
| **安全** | 支持安全隔离 |
| **优势** | 专为汽车SoC设计，低延迟 |
| **成本** | $2-4M (授权) |
| **交付时间** | 4-7个月 |

#### 方案 B: NetSpeed NoC (备选)

| 参数 | 规格 |
|------|------|
| **协议** | AXI, ACE |
| **优势** | 可配置性强 |
| **成本** | $1.5-3M (授权) |
| **交付时间** | 4-7个月 |

**推荐**: 方案 A (Arteris)，理由：汽车SoC经验丰富，支持安全特性。

### 3.5 外设 IP 选型

| 外设类型 | 推荐供应商 | 型号 | 关键特性 | 预估成本 | 交付时间 |
|----------|-----------|------|----------|----------|----------|
| **PCIe Gen4** | Synopsys | DesignWare PCIe 4.0 | x8 + x4，支持SR-IOV | $1-2M | 3-6个月 |
| **Ethernet TSN** | Cadence | MAC+PCS for 1G/10G | TSN支持，低延迟 | $0.8-1.5M | 3-6个月 |
| **USB 3.2** | Synopsys | DesignWare USB 3.2 | 4-6端口，10Gbps | $0.5-1M | 3-6个月 |
| **MIPI CSI-2** | Cadence | MIPI CSI-2 v2.0 | 16通道，4K支持 | $0.5-1M | 3-6个月 |
| **CAN FD** | Bosch | CAN FD控制器 | 16端口，5Mbps | $0.2-0.5M | 2-4个月 |
| **DisplayPort** | Synopsys | DesignWare DP 1.4 | 支持4K显示 | $0.3-0.7M | 3-6个月 |

### 3.6 安全 IP 选型

| 安全IP | 推荐方案 | 说明 | 预估成本 |
|--------|----------|------|----------|
| **ECC** | 自研 + ARM CoreSight | 基于ARM CoreSight ECC扩展 | $0.5-1M (开发) |
| **BIST** | Mentor Tessent MBIST/LBIST | 成熟BIST方案 | $1-2M (授权) |
| **看门狗** | 自研 | 定制窗口看门狗 | $0.3-0.6M (开发) |
| **监控电路** | 自研 + 第三方IP | 电压/温度/时钟监控 | $0.5-1M |

---

## 4. IP 集成计划

### 4.1 集成时间表

| 阶段 | 时间 | 活动 | 参与团队 |
|------|------|------|----------|
| **IP评估** | 2026-02 至 2026-03 | 技术评估，供应商谈判 | 架构、IP、采购 |
| **合同签署** | 2026-03 至 2026-04 | 授权协议签署 | 法务、采购、技术 |
| **IP交付** | 2026-04 至 2026-07 | IP交付，技术文档 | IP供应商 |
| **IP验证** | 2026-05 至 2026-08 | IP功能验证，集成测试 | 验证、设计 |
| **集成设计** | 2026-06 至 2026-09 | RTL集成，接口适配 | 设计、架构 |
| **系统验证** | 2026-09 至 2026-11 | 系统级验证 | 验证、设计 |

### 4.2 关键依赖关系

1. **CPU IP 先行**: ARM CPU IP 必须先确定，影响整体架构
2. **NoC 与内存控制器协同**: NoC 和内存控制器需协同设计
3. **安全 IP 早期集成**: 安全IP需早期集成验证
4. **外设 IP 可稍后**: 外设IP可稍后确定，但需预留接口

---

## 5. 成本预算

### 5.1 IP 授权费用预算

| IP 类别 | 供应商 | 授权费范围 | 版税模式 | 预估总额 |
|---------|--------|------------|----------|----------|
| **CPU (A78AE)** | ARM | $5-8M | 每片 $5-10 | $6M (授权) + 版税 |
| **CPU (R52)** | ARM | $2-4M | 每片 $2-5 | $3M (授权) + 版税 |
| **GPU (Mali-G78)** | ARM | $1-3M | 每片 $1-3 | $2M (授权) + 版税 |
| **内存控制器** | Cadence | $1-2M | 一次性 | $1.5M |
| **NoC** | Arteris | $2-4M | 一次性 | $3M |
| **PCIe** | Synopsys | $1-2M | 一次性 | $1.5M |
| **Ethernet** | Cadence | $0.8-1.5M | 一次性 | $1.2M |
| **USB** | Synopsys | $0.5-1M | 一次性 | $0.8M |
| **MIPI** | Cadence | $0.5-1M | 一次性 | $0.8M |
| **BIST** | Mentor | $1-2M | 一次性 | $1.5M |
| **其他外设** | 多家 | $1-2M | 一次性 | $1.5M |
| **总计** | - | - | - | **$23.8M** |

### 5.2 版税预估 (量产阶段)

| IP | 版税/片 | 年销量 100K | 年版税成本 |
|----|---------|------------|------------|
| ARM CPU | $8 | $800,000 | $800K |
| ARM GPU | $2 | $200,000 | $200K |
| 其他 IP | $5 | $500,000 | $500K |
| **总计** | **$15/片** | **100K片/年** | **$1.5M/年** |

### 5.3 总成本分析

| 成本类别 | 金额 | 占比 |
|----------|------|------|
| **IP授权费 (一次性)** | $23.8M | 61% |
| **IP版税 (年)** | $1.5M | 4% |
| **设计开发成本** | $10M | 26% |
| **验证成本** | $3M | 8% |
| **其他成本** | $1M | 3% |
| **总计 (首年)** | **$38.8M** | 100% |

**注**: 版税为持续成本，授权费为一次性投入。

---

## 6. 风险评估与缓解

### 6.1 技术风险

| 风险 | 描述 | 可能性 | 影响 | 缓解措施 |
|------|------|--------|------|----------|
| **IP集成困难** | 不同供应商IP接口不匹配 | 中 | 高 | 1. 选择标准接口协议 (AXI/APB)<br>2. 提前定义接口规范<br>3. 创建适配层 |
| **性能不达标** | IP实际性能低于标称 | 低 | 高 | 1. 要求供应商提供性能报告<br>2. 早期性能仿真<br>3. 合同包含性能条款 |
| **安全认证延迟** | IP未通过ASIL认证 | 中 | 高 | 1. 选择已认证IP<br>2. 要求供应商提供安全包<br>3. 预留认证时间 |

### 6.2 商务风险

| 风险 | 描述 | 可能性 | 影响 | 缓解措施 |
|------|------|--------|------|----------|
| **授权费用超支** | 谈判后费用超预算 | 中 | 中 | 1. 多供应商比价<br>2. 捆绑谈判<br>3. 考虑替代方案 |
| **交付延迟** | IP交付晚于计划 | 中 | 高 | 1. 合同明确交付时间<br>2. 设置违约金条款<br>3. 定期跟踪进度 |
| **技术支持不足** | 供应商支持不及时 | 低 | 中 | 1. 明确支持等级<br>2. 本地技术支持要求<br>3. 建立应急沟通渠道 |

### 6.3 供应链风险

| 风险 | 描述 | 可能性 | 影响 | 缓解措施 |
|------|------|--------|------|----------|
| **供应商倒闭** | IP供应商经营问题 | 低 | 高 | 1. 选择大型稳定供应商<br>2. 要求源代码托管<br>3. 有备选供应商 |
| **地缘政治风险** | 出口管制影响 | 中 | 高 | 1. 多地域供应商<br>2. 提前申请许可证<br>3. 本土替代方案 |

---

## 7. 供应商管理计划

### 7.1 供应商评估标准

| 评估维度 | 权重 | 评估指标 |
|----------|------|----------|
| **技术能力** | 30% | IP性能、质量、文档完整性 |
| **商务条款** | 25% | 价格、付款条件、授权范围 |
| **支持服务** | 20% | 技术支持、培训、响应时间 |
| **合作历史** | 15% | 过往合作经验、信誉 |
| **生态合作** | 10% | 与其他IP兼容性、工具链 |

### 7.2 供应商沟通计划

| 沟通类型 | 频率 | 参与者 | 目的 |
|----------|------|--------|------|
| **技术研讨会** | 每月 | 技术团队、供应商 | 技术方案讨论 |
| **项目周会** | 每周 | 项目经理、供应商PM | 进度跟踪 |
| **高层沟通** | 每季度 | 高层管理人员 | 战略合作 |
| **紧急沟通** | 按需 | 技术负责人 | 问题解决 |

---

## 8. 下一步行动

### 8.1 立即行动 (2026年1月)

1. **成立IP选型小组**
   - 成员：架构师、IP工程师、采购、法务
   - 职责：制定选型标准，启动供应商接触

2. **联系ARM初步谈判**
   - 目标：获取Cortex-A78AE和R52初步报价
   - 时间：2026-01-25前完成首次会议

3. **制定详细评估计划**
   - 为每个IP类别制定评估检查清单
   - 计划完成：2026-01-31

### 8.2 短期计划 (2026年2-3月)

4. **供应商技术评估**
   - 收集技术资料，进行初步评估
   - 计划：2026-02-28前完成技术评估

5. **商务谈判启动**
   - 与2-3家供应商并行谈判
   - 目标：2026-03-31前达成初步协议

6. **IP集成规划**
   - 制定IP集成技术方案
   - 识别潜在集成风险

### 8.3 中期计划 (2026年4-5月)

7. **合同签署**
   - 完成主要IP合同签署
   - 目标：2026-04-30前

8. **IP交付准备**
   - 准备IP集成环境
   - 制定IP验证计划

9. **启动IP验证**
   - 接收第一批IP，开始验证
   - 目标：2026-05-31前

---

## 9. 审批

### 9.1 审批流程

1. IP选型小组推荐方案
2. 架构评审委员会技术评审
3. 采购委员会商务评审
4. 项目经理批准
5. CEO最终批准

### 9.2 签署

| 角色 | 姓名 | 签名 | 日期 |
|------|------|------|------|
| 首席架构师 | [待确认] | - | - |
| IP经理 | [待确认] | - | - |
| 采购经理 | [待确认] | - | - |
| 项目经理 | [待确认] | - | - |

---

**文档版本**: V1.0  
**最后更新**: 2026-01-18  
**状态**: 草稿  
**下一步**: 成立IP选型小组，启动ARM谈判

---
*本文件作为摇光 SoC IP 选型的指导文件，将根据谈判进展和技术评估结果持续更新。*