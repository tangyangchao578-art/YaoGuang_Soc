# 摇光(YaoGuang) SoC 系统接口规格

## 文档信息

| 项目 | 内容 |
|------|------|
| 文档版本 | V1.0 |
| 创建日期 | 2026-01-19 |
| 最后更新 | 2026-01-19 |
| 状态 | 草稿 |
| 负责人 | 接口架构师 |
| 关联文档 | 架构规格书 (01_Architecture_Spec_YaoGuang_SoC.md) |

---

## 1. 概述

### 1.1 接口设计目标

| 指标 | 目标值 | 备注 |
|------|--------|------|
| **接口标准化** | 100% | 采用行业标准协议 |
| **接口带宽** | 满足系统需求 | 总计 > 500 GB/s |
| **延迟** | 最小化 | 关键路径 < 50 cycles |
| **可扩展性** | 支持未来扩展 | 预留升级空间 |

### 1.2 接口分类

| 类别 | 协议 | 带宽 | 用途 |
|------|------|------|------|
| **处理器接口** | AXI4/5, ACE4 | 256 GB/s | CPU/GPU 连接 |
| **加速器接口** | AXI4, CHI | 200 GB/s | NPU 连接 |
| **存储器接口** | LPDDR5 | 200 GB/s | 外部内存 |
| **高速外设** | PCIe Gen4, USB 3.2 | 64 GB/s | 外部设备 |
| **车载接口** | CAN FD, Ethernet | 10 GB/s | 车载网络 |
| **图像接口** | MIPI CSI-2 | 32 GB/s | 摄像头输入 |

---

## 2. 处理器接口

### 2.1 AXI4/5 接口规格

| 参数 | 主接口 (Master) | 从接口 (Slave) |
|------|-----------------|-----------------|
| **协议** | AXI4/AXI5 | AXI4/AXI5 |
| **数据位宽** | 512-bit | 512-bit |
| **频率** | 2.0 GHz | 2.0 GHz |
| **带宽** | 128 GB/s | 128 GB/s |
| **事务深度** | 64 | 64 |
| **Outstanding** | 32 | 32 |

#### 2.1.1 AXI 通道信号

| 通道 | 信号 | 位宽 | 说明 |
|------|------|------|------|
| **写地址** | AWVALID | 1 | 写地址有效 |
| | AWREADY | 1 | 写地址就绪 |
| | AWADDR | 64 | 写地址 |
| | AWLEN | 8 | 突发长度 |
| | AWSIZE | 3 | 突发大小 |
| | AWBURST | 2 | 突发类型 |
| | AWPROT | 3 | 保护类型 |
| | AWQOS | 4 | QoS 优先级 |
| **写数据** | WVALID | 1 | 写数据有效 |
| | WREADY | 1 | 写数据就绪 |
| | WDATA | 512 | 写数据 |
| | WSTRB | 64 | 写字节使能 |
| | WLAST | 1 | 突发结束 |
| **写响应** | BVALID | 1 | 写响应有效 |
| | BREADY | 1 | 写响应就绪 |
| | BRESP | 2 | 写响应 |
| **读地址** | ARVALID | 1 | 读地址有效 |
| | ARREADY | 1 | 读地址就绪 |
| | ARADDR | 64 | 读地址 |
| | ARLEN | 8 | 突发长度 |
| | ARSIZE | 3 | 突发大小 |
| | ARBURST | 2 | 突发类型 |
| | ARPROT | 3 | 保护类型 |
| | ARQOS | 4 | QoS 优先级 |
| **读数据** | RVALID | 1 | 读数据有效 |
| | RREADY | 1 | 读数据就绪 |
| | RDATA | 512 | 读数据 |
| | RRESP | 2 | 读响应 |
| | RLAST | 1 | 突发结束 |

### 2.2 ACE4 接口规格

| 参数 | 规格 |
|------|------|
| **协议** | ACE4 (AXI Coherency Extensions) |
| **数据位宽** | 512-bit |
| **频率** | 2.0 GHz |
| **带宽** | 256 GB/s (双向) |
| **一致性域** | 全芯片 (CPU + GPU) |
| **DVM 支持** | 是 |

#### 2.2.1 ACE 扩展信号

| 信号 | 位宽 | 说明 |
|------|------|------|
| **ACADDR** | 64 | 监听地址 |
| **ACVALID** | 1 | 监听有效 |
| **ACREADY** | 1 | 监听就绪 |
| **CRRESP** | 4 | 监听响应 |
| **CDDATA** | 512 | 监听数据 |
| **SNOOPVALID** | 1 | 监听发起有效 |
| **SNOOPREADY** | 1 | 监听发起就绪 |
| **DVM** | 2 | DVM 消息 |

---

## 3. 存储器接口

### 3.1 LPDDR5 接口规格

| 参数 | 规格 |
|------|------|
| **标准** | LPDDR5 (JESD209-5) |
| **数据速率** | 6400 MT/s |
| **通道** | 2 x 16-bit |
| **峰值带宽** | 200 GB/s (双向) |
| **DQS** | 差分时钟 |
| **命令速率** | 1:16 (相对于数据) |

#### 3.1.1 LPDDR5 信号

| 信号组 | 信号 | 位宽 | 说明 |
|--------|------|------|------|
| **数据** | DQ[15:0] | 16/通道 | 数据总线 |
| | DQS_C, DQS_T | 2/通道 | 数据选通 |
| | DMI[1:0] | 2/通道 | 数据掩码 |
| **地址/命令** | A[16:0] | 18 | 地址 |
| | BA[1:0] | 2 | Bank 地址 |
| | BG[1:0] | 2 | Bank Group |
| | CS_N | 1 | Chip Select |
| | WE_N, CAS_N, RAS_N | 3 | 命令 |
| **时钟** | CK_C, CK_T | 2 | 差分时钟 |
| **电源** | VDD, VDDQ, VSS | - | 电源/地 |

### 3.2 DFI 接口

| 信号 | 方向 | 位宽 | 说明 |
|------|------|------|------|
| **DFI clock** | To PHY | 1 | DFI 时钟 |
| **DFI reset** | To PHY | 1 | DFI 复位 |
| **wrdata** | To PHY | 512 | 写数据 |
| **wrdata_en** | To PHY | 4 | 写数据使能 |
| **wrdata_mask** | To PHY | 64 | 写数据掩码 |
| **rddata** | From PHY | 512 | 读数据 |
| **rddata_en** | From PHY | 4 | 读数据使能 |
| **rddata_valid** | From PHY | 1 | 读数据有效 |

---

## 4. 高速外设接口

### 4.1 PCIe Gen4 接口

| 参数 | 规格 |
|------|------|
| **标准** | PCI Express Base Spec 4.0 |
| **通道数** | x8 + x4 |
| **数据速率** | 16 GT/s/lane |
| **带宽** | 16 GB/s (x8) + 8 GB/s (x4) |
| **协议层** | Transaction/Data Link/Physical |
| **SR-IOV** | 支持 (最大 64 VF) |

#### 4.1.1 PCIe 信号

| 信号 | 方向 | 位宽 | 说明 |
|------|------|------|------|
| **TX_P/N** | 输出 | 8/4 lanes | 发送差分对 |
| **RX_P/N** | 输入 | 8/4 lanes | 接收差分对 |
| **REFCLK** | 输入 | 2 | 参考时钟 |
| **PERST_N** | 输入 | 1 | 复位 |
| **WAKE_N** | 输出 | 1 | 唤醒 |

### 4.2 USB 3.2 接口

| 参数 | 规格 |
|------|------|
| **标准** | USB 3.2 Gen2 |
| **速率** | 10 Gbps |
| **端口数** | 4-6 ports |
| **协议** | SuperSpeed+ |
| **供电** | BC 1.2 (5V/1.5A) |

#### 4.2.1 USB 信号

| 信号 | 方向 | 位宽 | 说明 |
|------|------|------|------|
| **TX_P/N** | 输出 | 差分 | 发送 |
| **RX_P/N** | 输入 | 差分 | 接收 |
| **VBUS** | 输入 | 1 | 供电检测 |
| **ID** | 输入 | 1 | OTG ID |

### 4.3 Ethernet 接口

| 参数 | 规格 |
|------|------|
| **标准** | IEEE 802.3 |
| **速率** | 10 Gbps / 1 Gbps |
| **接口** | 10GBASE-R / 1000BASE-T |
| **TSN** | 支持 (802.1Qbv, 802.1AS) |
| **PHY 接口** | XGMII / RGMII |

#### 4.3.1 Ethernet 信号 (10G)

| 信号 | 方向 | 位宽 | 说明 |
|------|------|------|------|
| **TXD[63:0]** | 输出 | 64 | 发送数据 |
| **TXC[7:0]** | 输出 | 8 | 发送控制 |
| **RXD[63:0]** | 输入 | 64 | 接收数据 |
| **RXC[7:0]** | 输入 | 8 | 接收控制 |
| **MDC/MDIO** | 双向 | 1 | 管理接口 |

---

## 5. 车载接口

### 5.1 CAN FD 接口

| 参数 | 规格 |
|------|------|
| **标准** | ISO 11898-2 (CAN FD) |
| **速率** | 5 Mbps (数据阶段) |
| **端口数** | 8-16 ports |
| **CAN-FD** | 支持 (64-byte 帧) |
| **CAN XL** | 可选支持 |

#### 5.1.1 CAN 信号

| 信号 | 方向 | 说明 |
|------|------|------|
| **CANH/CANL** | 差分 | CAN 总线 |
| **TXCAN** | 输出 | 发送数据 |
| **RXCAN** | 输入 | 接收数据 |
| **STB_N** | 输出 | 待机控制 |

### 5.2 MIPI CSI-2 接口

| 参数 | 规格 |
|------|------|
| **标准** | MIPI CSI-2 v2.0 |
| **通道数** | 8-16 lanes |
| **速率** | 4.5 Gbps/lane (D-PHY) |
| **分辨率** | 4K @ 60fps |
| **RAW 格式** | RAW8/10/12/14/16 |

#### 5.2.1 MIPI CSI-2 信号 (D-PHY)

| 信号 | 方向 | 位宽 | 说明 |
|------|------|------|------|
| **CLKP/N** | 输入 | 差分 | 时钟 lane |
| **D[7:0]P/N** | 输入 | 8 差分对 | 数据 lanes |
| **I2C** | 双向 | 2 | DDC (EDID) |

### 5.3 Display 接口

| 参数 | 规格 |
|------|------|
| **标准** | HDMI 2.0 / DP 1.4 |
| **HDMI 分辨率** | 4K @ 60Hz |
| **DP 分辨率** | 8K @ 60Hz |
| **HDCP** | 支持 (2.3) |
| **Audio** | 支持 (ARC/eARC) |

---

## 6. 低速外设接口

### 6.1 APB4 接口

| 参数 | 规格 |
|------|------|
| **协议** | APB4 (AMBA) |
| **数据位宽** | 32-bit |
| **地址位宽** | 32-bit |
| **频率** | 500 MHz |
| **带宽** | 2 GB/s |

### 6.2 GPIO 接口

| 参数 | 规格 |
|------|------|
| **数量** | 64-128 pins |
| **方向** | 可配置输入/输出 |
| **中断** | 支持 (边沿/电平) |
| **上拉/下拉** | 可配置 |

### 6.3 其他接口

| 接口 | 数量 | 用途 |
|------|------|------|
| **UART** | 4-8 ports | 调试/通信 |
| **SPI** | 4-8 ports | Flash/外设 |
| **I2C** | 8-16 ports | 传感器/EEPROM |
| **I2S/TDM** | 4-8 channels | Audio |
| **PWM** | 16-32 channels | 电机控制 |

---

## 7. 接口时序规格

### 7.1 AXI4 时序

| 参数 | 最小值 | 最大值 | 说明 |
|------|--------|--------|------|
| **TVALID 保持** | 1 cycle | - | 有效信号保持 |
| **TREADY 等待** | 0 | - | 就绪信号等待 |
| **读延迟** | 2 cycles | 50 cycles | 典型/最大读延迟 |
| **写延迟** | 1 cycle | 20 cycles | 典型/最大写延迟 |

### 7.2 PCIe Gen4 时序

| 参数 | 规格 |
|------|------|
| **Reference Clock** | 100 MHz ±300 ppm |
| **Preset De-emphasis** | 可编程 |
| **Tx/Rx Equalization** | 自适应 |

### 7.3 MIPI D-PHY 时序

| 参数 | 规格 |
|------|------|
| **Clock Frequency** | 1.5-4.5 GHz |
| **Data Rate** | 3-9 Gbps/lane |
| **LP Mode Frequency** | 10-20 MHz |
| **Setup Time** | > 0.15 UI |
| **Hold Time** | > 0.15 UI |

---

## 8. IO 规格

### 8.1 IO 电源域

| 电源域 | 电压 | 用途 |
|--------|------|------|
| **VDD_CPU** | 0.8-1.0V | CPU 核心 |
| **VDD_IO** | 1.8V / 3.3V | GPIO/外设 |
| **VDD_DDR** | 1.1V | LPDDR5 |
| **VDD_PCIE** | 0.9V | PCIe |
| **VDD_USB** | 3.3V | USB |

### 8.2 IO 特性

| 接口类型 | 驱动能力 | 边沿速率 | ESD 保护 |
|----------|----------|----------|----------|
| **GPIO** | 可配置 2-16 mA | 可配置 | 2 kV HBM |
| **MIPI CSI** | CML | 100 ps | 2 kV HBM |
| **CAN FD** | ISO 11898-2 | - | ±8 kV HBM |
| **USB** | USB 3.2 规范 | - | 2 kV HBM |
| **Ethernet** | MLT-3 / PAM4 | - | 2 kV HBM |

---

## 9. 安全接口

### 9.1 安全监测接口

| 信号 | 方向 | 功能 |
|------|------|------|
| **ERR_OUT** | 输出 | 错误标志 |
| **ERR_TYPE** | 输出 | 错误类型 |
| **ERR_ADDR** | 输出 | 错误地址 |
| **WARN_OUT** | 输出 | 警告标志 |

### 9.2 调试接口

| 接口 | 协议 | 用途 |
|------|------|------|
| **JTAG** | IEEE 1149.1 | 边界扫描/调试 |
| **SWD** | ARM SWD | 调试 |
| **Trace** | CoreSight | 性能跟踪 |
| **CTI** | ARM CTI | 触发控制 |

---

## 10. 接口验证

### 10.1 验证目标

| 验证类型 | 覆盖率目标 | 工具 |
|----------|------------|------|
| **协议一致性** | 100% | VIP (AXI/PCIe/USB) |
| **功能测试** | 100% | UVM |
| **性能测试** | 目标带宽达成 | 仿真 + 性能模型 |
| **互操作性** | 通过 | 兼容性测试 |

### 10.2 验证用例

| 用例类别 | 用例数 | 说明 |
|----------|--------|------|
| **协议测试** | 500+ | AXI/PCIe/USB 协议测试 |
| **功能测试** | 300+ | 接口功能测试 |
| **性能测试** | 100+ | 带宽/延迟测试 |
| **异常测试** | 200+ | 错误注入测试 |

---

## 11. 交付物和时间表

| 交付物 | 截止日期 | 状态 |
|--------|----------|------|
| 接口规格 | 2026-03-15 | 未开始 |
| VIP 开发 | 2026-05-15 | 未开始 |
| 接口集成 | 2026-06-30 | 未开始 |
| 互操作性测试 | 2026-09-30 | 未开始 |

---

## 12. 审批

| 角色 | 姓名 | 签名 | 日期 |
|------|------|------|------|
| 接口架构师 | [待确认] | - | - |
| 首席架构师 | [待确认] | - | - |
| 项目经理 | [待确认] | - | - |

---

**文档版本**: V1.0  
**最后更新**: 2026-01-19  
**状态**: 草稿  
**下一步**: 开始接口 RTL 开发

---
*本规格书作为系统接口详细设计的指导文件。*