---
name: chip-architect
description: 芯片架构设计和微架构指导。用于定义芯片系统架构、微架构设计、PPA（性能-功耗-面积）权衡、设计空间探索和架构决策支持。
---

# Chip Architect

## 概述

此技能为芯片/半导体首席架构师提供专门化指导，涵盖从系统规格到微架构设计的完整流程。帮助架构师做出关键设计决策，定义硬件架构，并进行PPA（Performance, Power, Area）权衡分析。

## 使用场景

当用户请求以下任务时，应使用此技能：
- 芯片系统架构定义和规格
- 微架构设计和优化
- PPA分析和设计空间探索
- 架构决策和权衡
- 接口和协议选择
- 缓存层次结构设计
- 性能建模和验证
- 功耗预算和优化

## 芯片架构设计流程

### 1. 需求分析阶段
- 理解市场需求和产品规格
- 定义性能指标（带宽、吞吐量、延迟）
- 确定功耗预算（动态、静态、峰值）
- 设定面积目标和成本约束
- 识别关键IP需求

### 2. 系统架构设计
- 功能块划分
- 数据流和控制流设计
- 内存层次结构设计
- 时钟域规划
- 接口和总线架构
- 电源域和电源管理

### 3. 微架构设计
- 指令集架构（ISA）定义
- 流水线深度和级设计
- 执行单元和数据通路设计
- 缓存配置（L1/L2/L3）
- 分支预测策略
- 乱序执行设计

### 4. PPA权衡和优化
- 性能vs面积权衡
- 性能vs功耗权衡
- 设计空间探索
- 敏感性分析
- 关键路径优化
- 功耗优化技术

### 5. 架构文档
- 架构规格文档
- 微架构规格书
- 性能模型和估算
- 功耗分析报告
- 面积估算

## 关键设计考量

### 性能设计

**关键指标：**
- **IPC（Instructions Per Cycle）**: 每周期执行指令数
- **频率**: 目标时钟频率（如 2.0GHz）
- **吞吐量**: 每秒处理事务数
- **延迟**: 关键操作响应时间

**优化技术：**
- 流水线深度优化（深流水线 vs 分支惩罚）
- 分支预测准确率提升
- 乱序执行窗口大小
- 向量化支持
- 超标量和硬件加速器

### 功耗设计

**功耗类型：**
- **动态功耗**: 与开关活动相关
- **静态功耗**: 漏电流
- **峰值功耗**: 最大瞬时功耗

**优化技术：**
- 时钟门控
- 电源门控
- 电压频率缩放（DVFS）
- 电压岛隔离
- 低功耗模式（idle状态）

### 面积设计

**面积组成：**
- 逻辑门数
- 存储器大小（SRAM、寄存器）
- 布线开销
- 物理设计余量

**优化技术：**
- IP复用
- 资源共享
- 标准单元选择
- 布线优化

## 缓存层次结构设计

### L1 Cache
- **指令Cache（I-Cache）**: 大小、关联度、替换策略
- **数据Cache（D-Cache）**: 大小、关联度、替换策略
- **统一Cache vs 分离Cache**: 权衡考虑

### L2/L3 Cache
- **大小和延迟**: 容量vs访问延迟权衡
- **包含性**: 共享缓存策略
- **一致性协议**: MESI、MOESI等

### TLB（Translation Lookaside Buffer）
- **Entry数量**: 虚拟地址覆盖
- **关联度**: 提升TLB命中率

## 接口和协议选择

### 处理器接口
- **总线协议**: AXI4/5、AHB、CHI、ACE
- **一致性协议**: Cache一致性协议选择
- **调试接口**: 跟踪和调试支持

### 内存接口
- **DDR类型**: DDR3、DDR4、DDR5、LPDDR
- **接口宽度**: 通道数、数据位宽
- **时序参数**: CAS延迟、突发长度

### 加速器接口
- **PCIe**: Gen3/Gen4/Gen5
- **DMA**: 直接内存访问控制器
- **自定义接口**: 专用加速器接口

## 设计空间探索

### 评估维度

| 维度 | 选项1 | 选项2 | 选项3 |
|------|--------|--------|--------|
| 流水线深度 | 5级 | 7级 | 9级 |
| 发射宽度 | 单发射 | 双发射 | 四发射 |
| Cache配置 | 私有L1 | 共享L1 | 无L1 |
| 分支预测 | 静态预测 | GShare | TAGE |

### 权衡分析

使用定量分析方法比较选项：
- 性能模拟（如Gem5、SST）
- 功耗分析（如McPAT、PowerArtist）
- 面积估算（如Design Compiler）
- 成本分析（IP许可、晶圆成本）

## 性能建模

### 模拟工具
- **周期精确模拟器**: Gem5、Simics、ZSim
- **功能模拟器**: Spike、riscv-isa-sim
- **自研模型**: C++/SystemC模型

### 分析指标
- **SPEC CPU**: 标准性能基准测试
- **工作负载分析**: 常见应用特征
- **性能预测**: 基于模型的性能估计

## 常见架构模式

### 流水线设计
- **RISC（精简指令集）**：简单的5级流水线
- **超标量**: 多发射并行执行
- **乱序执行（OOO）**: 动态调度和重排序

### 异构架构
- **CPU + GPU**: 大规模并行
- **CPU + FPGA**: 可重构逻辑
- **CPU + AI加速器**: 神经网络推理

### 大小核（big.LITTLE）
- **大核**: 高性能、高功耗
- **小核**: 高能效、低性能
- **任务调度**: OS级调度策略

## 架构决策记录

### 决策矩阵

| 决策 | 选项A | 选项B | 选择 | 理由 |
|--------|--------|--------|------|--------|
| ISA选择 | RISC-V | ARM | RISC-V | 开放生态、免授权费 |
| 流水线深度 | 5级 | 7级 | 5级 | 分支惩罚低 |
| Cache大小 | 32KB | 64KB | 64KB | 命中率高 |

### 架构变更管理

**变更流程：**
1. 提出架构变更提案
2. 影响分析（性能、功耗、面积）
3. 团队评审
4. 批准和记录
5. 实施和验证

## 参考资料

### 架构设计原则
- **Amdahl定律**: 并行化收益分析
- **摩尔定律**: 工艺演进趋势
- **丹宁量表**: 存储层次结构
- **Flynn分类**: SISD、SIMD、MIMD、MISD

### 行业标准
- RISC-V规范
- ARM架构参考手册
- AMBA协议规范
- DDR Jedec标准
