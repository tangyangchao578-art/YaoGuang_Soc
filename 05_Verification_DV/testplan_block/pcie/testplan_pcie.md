# PCIe Controller 验证计划

| 文档版本 | V1.0 |
|---------|------|
| 创建日期 | 2026-01-18 |
| 状态 | 进行中 |
| ASIL 等级 | QM |

---

## 1. 模块概述

### 1.1 功能描述
PCIe Gen4 控制器，支持 16 通道，提供高速外设互联。

### 1.2 验证范围
- PCIe 物理层
- 数据链路层
- 事务层
- 配置空间

---

## 2. 测试点列表

### 2.1 链路层测试

| ID | 测试点 | 优先级 | 类型 | 期望结果 |
|----|--------|--------|------|----------|
| PCIE-LINK-001 | 链路训练 | P0 | 功能 | 训练成功 |
| PCIE-LINK-002 | 链路宽度协商 | P0 | 功能 | 宽度正确 |
| PCIE-LINK-003 | 链路速率协商 | P0 | 功能 | 速率正确 |
| PCIE-LINK-004 | 链路状态监控 | P1 | 功能 | 状态正确 |

### 2.2 事务层测试

| ID | 测试点 | 优先级 | 类型 | 期望结果 |
|----|--------|--------|------|----------|
| PCIE-TLP-001 | Memory Read | P0 | 功能 | 正确 |
| PCIE-TLP-002 | Memory Write | P0 | 功能 | 正确 |
| PCIE-TLP-003 | IO Read/Write | P0 | 功能 | 正确 |
| PCIE-TLP-004 | Config Read/Write | P0 | 功能 | 正确 |
| PCIE-TLP-005 | Message | P1 | 功能 | 正确 |
| PCIE-TLP-006 | Atomic Op | P1 | 功能 | 正确 |

### 2.3 配置空间测试

| ID | 测试点 | 优先级 | 类型 | 期望结果 |
|----|--------|--------|------|----------|
| PCIE-CFG-001 | Type 0 配置 | P0 | 功能 | 正确 |
| PCIE-CFG-002 | Type 1 配置 | P0 | 功能 | 正确 |
| PCIE-CFG-003 | Capability 结构 | P0 | 功能 | 正确 |
| PCIE-CFG-004 | AER 支持 | P1 | 功能 | 正确 |

### 2.4 错误处理测试

| ID | 测试点 | 优先级 | 类型 | 期望结果 |
|----|--------|--------|------|----------|
| PCIE-ERR-001 | 奇偶校验错误 | P0 | 异常 | 检测 |
| PCIE-ERR-002 | 链路错误 | P0 | 异常 | 检测 |
| PCIE-ERR-003 | TLP 错误 | P0 | 异常 | 检测 |
| PCIE-ERR-004 | 错误通知 | P0 | 功能 | 正确 |

### 2.5 性能测试

| ID | 测试点 | 优先级 | 类型 | 期望结果 |
|----|--------|--------|------|----------|
| PCIE-PERF-001 | 带宽测试 | P0 | 性能 | ≥ 32GB/s |
| PCIE-PERF-002 | 延迟测试 | P1 | 性能 | 延迟符合 |
| PCIE-PERF-003 | 吞吐量测试 | P0 | 性能 | 吞吐达标 |

---

## 3. 验证环境

```
pcie_tb/
├── pcie_env.sv
├── pcie_agent.sv
├── pcie_scoreboard.sv
├── pcie_coverage.sv
└── pcie_sequencer.sv
```

---

## 4. 覆盖率要求

| 覆盖率类型 | 目标 |
|------------|------|
| 代码覆盖率 | ≥ 95% |
| 功能覆盖率 | 100% |
| 断言覆盖率 | ≥ 90% |

---

## 5. 测试用例清单

| 用例名称 | 对应测试点 | 优先级 |
|----------|------------|--------|
| test_pcie_link_training | PCIE-LINK-001~004 | P0 |
| test_pcie_tlp_basic | PCIE-TLP-001~003 | P0 |
| test_pcie_config_access | PCIE-CFG-001~004 | P0 |
| test_pcie_error_handling | PCIE-ERR-001~004 | P0 |
| test_pcie_performance | PCIE-PERF-001~003 | P0 |

---

**创建日期**: 2026-01-18
