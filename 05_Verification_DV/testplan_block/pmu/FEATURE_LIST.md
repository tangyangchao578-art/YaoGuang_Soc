# Feature List - PMU (Power Management Unit)

## 基本信息

| 项目 | 内容 |
|------|------|
| **模块名称** | PMU (Power Management Unit) |
| **版本** | V1.0 |
| **作者** | Frontend Designer |
| **创建日期** | 2026-01-19 |
| **关联Spec版本** | V1.0 (11_Power_Management_Architecture.md) |

---

## Feature列表

| ID | Feature描述 | 优先级 | 验证类型 | 依赖项 | 验收标准 |
|----|------------|--------|----------|--------|----------|
| FE_001 | 8个独立电源域开关控制 | P0 | 功能 | 无 | PD_CPU~PD_RTC独立控制 |
| FE_002 | 可编程上电序列 | P0 | 功能 | 无 | 序列可配置，延时可编程 |
| FE_003 | 可编程下电序列 | P0 | 功能 | 无 | 序列可配置，延时可编程 |
| FE_004 | 10通道电压监控 | P0 | 功能 | 无 | 精度±1~2%，采样率1MHz |
| FE_005 | 8通道温度监控 | P0 | 功能 | 无 | 精度±1°C，范围-40~150°C |
| FE_006 | 5通道电流监控 | P0 | 功能 | 无 | 精度±2~3%，采样率1MHz |
| FE_007 | 16级DVFS控制 | P0 | 功能 | 无 | CPU/NPU/GPU独立调节 |
| FE_008 | 动态功耗统计 | P1 | 功能 | 无 | 模块级功耗计算 |
| FE_009 | 静态功耗统计 | P1 | 功能 | 无 | 模块级功耗计算 |
| FE_010 | 系统看门狗 | P0 | 功能 | 无 | 超时复位，支持1ms~10s |
| FE_011 | 6级低功耗模式 | P0 | 功能 | 无 | Active/Idle/Standby/Sleep/Deep Sleep/Shutdown |
| FE_012 | 多源唤醒支持 | P0 | 功能 | 无 | GPIO/RTC/CAN/USB/看门狗 |
| FE_013 | 电源状态机 | P0 | 功能 | 无 | FSM状态切换正确 |
| FE_014 | 保持寄存器 | P1 | 功能 | 无 | 休眠模式下数据保持 |
| FE_015 | 时钟门控控制 | P0 | 功能 | 无 | 空闲模块时钟关闭 |
| FE_016 | 过压保护 | P0 | 异常 | 无 | 检测到关断 |
| FE_017 | 欠压保护 | P0 | 异常 | 无 | 检测到复位 |
| FE_018 | 过流保护 | P0 | 异常 | 无 | 检测到降频/关断 |
| FE_019 | 过温保护 | P0 | 异常 | 无 | 检测到降频/关断 |
| FE_020 | 看门狗超时 | P0 | 异常 | 无 | 检测到系统复位 |
| FE_021 | 电压监测中断 | P1 | 功能 | 无 | 阈值触发中断 |
| FE_022 | 温度告警中断 | P1 | 功能 | 无 | 阈值触发中断 |
| FE_023 | 功耗超限中断 | P1 | 功能 | 无 | 阈值触发中断 |
| FE_024 | 电源状态中断 | P1 | 功能 | 无 | 状态变化触发中断 |
| FE_025 | APB3接口 | P0 | 功能 | 无 | 标准APB3读写 |
| FE_026 | 独立RTC域 | P0 | 功能 | 无 | 1.2V独立供电 |
| FE_027 | 异步复位同步 | P0 | 功能 | 无 | 多时钟域复位安全 |
| FE_028 | 电源域隔离 | P0 | 功能 | 无 | 上下电隔离正确 |

---

### FE_001: 8个独立电源域开关控制

- **描述**: PMU应能够独立控制8个电源域的上电/下电：PD_CPU、PD_SAFETY、PD_NPU、PD_GPU、PD_NOC、PD_MEM、PD_SYS、PD_IO、PD_ANA、PD_RTC
- **前置条件**: PMU已初始化，电压调节器工作正常
- **测试步骤**:
  1. 通过APB寄存器配置各电源域开关
  2. 观察电源域控制信号
- **预期结果**: 各电源域控制信号独立可编程
- **边界条件**: 所有域同时开关、快速连续开关
- **关联需求**: 2.1 电源域定义

### FE_002: 可编程上电序列

- **描述**: PMU应支持可编程的上电序列，每个域可配置独立的延时
- **前置条件**: PMU已初始化
- **测试步骤**:
  1. 配置上电序列和延时
  2. 触发上电
  3. 观察各域上电时序
- **预期结果**: 按配置序列上电，延时符合设置
- **边界条件**: 延时最小值(0)/最大值、序列冲突
- **关联需求**: 1.1 电源管理设计目标

### FE_003: 可编程下电序列

- **描述**: PMU应支持可编程的下电序列，每个域可配置独立的延时
- **前置条件**: PMU已初始化
- **测试步骤**:
  1. 配置下电序列和延时
  2. 触发下电
  3. 观察各域下电时序
- **预期结果**: 按配置序列下电，延时符合设置
- **边界条件**: 延时最小值/最大值、紧急下电
- **关联需求**: 1.1 电源管理设计目标

### FE_004: 10通道电压监控

- **描述**: PMU应监控10个电压点：VDD_CPU、VDD_NPU、VDD_GPU、VDD_IO、VDD_MEM等，精度±1~2%
- **前置条件**: ADC模块工作正常
- **测试步骤**:
  1. 配置监控通道和采样率
  2. 读取各通道电压值
  3. 验证精度
- **预期结果**: 电压值准确，精度符合要求
- **边界条件**: 过压、欠压、电压剧变
- **关联需求**: 3.2 电压监控

### FE_005: 8通道温度监控

- **描述**: PMU应监控8个温度点：CPU、NPU、GPU、NoC、Memory、IO、PMU、外部，精度±1°C
- **前置条件**: 温度传感器工作正常
- **测试步骤**:
  1. 配置监控通道和采样率
  2. 读取各通道温度值
  3. 验证精度
- **预期结果**: 温度值准确，精度符合要求
- **边界条件**: 超低温(-40°C)、超高温(150°C)
- **关联需求**: 8.1 温度传感器

### FE_006: 5通道电流监控

- **描述**: PMU应监控5个电流点：CPU、NPU、GPU、Memory、IO，精度±2~3%
- **前置条件**: 电流传感器工作正常
- **测试步骤**:
  1. 配置监控通道和采样率
  2. 读取各通道电流值
  3. 验证精度
- **预期结果**: 电流值准确，精度符合要求
- **边界条件**: 过流、电流剧变
- **关联需求**: 7.1 功耗监测

### FE_007: 16级DVFS控制

- **描述**: PMU应支持16级动态电压频率调节，对CPU/NPU/GPU进行独立控制
- **前置条件**: 电压调节器和时钟控制器工作正常
- **测试步骤**:
  1. 配置DVFS等级和目标模块
  2. 触发DVFS调节
  3. 观察电压和频率变化
- **预期结果**: 电压和频率按配置调节
- **边界条件**: 最高/最低档位、连续档位切换
- **关联需求**: 1.1 电源管理设计目标

### FE_008: 动态功耗统计

- **描述**: PMU应能够计算各模块的动态功耗
- **前置条件**: 电流和电压监控正常
- **测试步骤**:
  1. 配置功耗统计参数
  2. 读取动态功耗值
- **预期结果**: 动态功耗值合理
- **边界条件**: 高负载、低负载、空闲
- **关联需求**: 7.2 功耗预算

### FE_009: 静态功耗统计

- **描述**: PMU应能够计算各模块的静态功耗
- **前置条件**: 系统在低功耗模式
- **测试步骤**:
  1. 进入低功耗模式
  2. 读取静态功耗值
- **预期结果**: 静态功耗值符合预算
- **边界条件**: 各电源域独立关断
- **关联需求**: 7.2 功耗预算

### FE_010: 系统看门狗

- **描述**: PMU应提供独立看门狗，支持1ms~10s超时配置
- **前置条件**: PMU已初始化
- **测试步骤**:
  1. 配置看门狗超时时间
  2. 定期喂狗
  3. 不喂狗等待超时
- **预期结果**: 超时后触发系统复位
- **边界条件**: 最小/最大超时、连续超时
- **关联需求**: 4.1 PMU功能

### FE_011: 6级低功耗模式

- **描述**: PMU应支持6级低功耗模式：Active、Idle、Standby、Sleep、Deep Sleep、Shutdown
- **前置条件**: PMU已初始化，各电源域正常
- **测试步骤**:
  1. 配置进入各低功耗模式
  2. 验证各模式状态
  3. 唤醒恢复
- **预期结果**: 各模式正确切换，功耗符合预期
- **边界条件**: 各模式间快速切换、异常唤醒
- **关联需求**: 6.1 低功耗模式定义

### FE_012: 多源唤醒支持

- **描述**: PMU应支持5种唤醒源：GPIO中断、RTC闹钟、CAN报文、USB插入、看门狗
- **前置条件**: 唤醒源配置使能
- **测试步骤**:
  1. 配置各唤醒源
  2. 触发唤醒事件
  3. 验证唤醒响应
- **预期结果**: 各唤醒源正确触发唤醒
- **边界条件**: 多唤醒源同时触发、快速连续唤醒
- **关联需求**: 6.2 唤醒源

### FE_013: 电源状态机

- **描述**: PMU应实现电源管理FSM，控制各电源域状态
- **前置条件**: PMU已初始化
- **测试步骤**:
  1. 观察FSM状态变化
  2. 触发状态切换
  3. 验证状态转换正确性
- **预期结果**: FSM状态转换正确
- **边界条件**: 异常状态、非法转换
- **关联需求**: 4.2 PMU架构

### FE_014: 保持寄存器

- **描述**: PMU应提供保持寄存器，在休眠模式下保持关键数据
- **前置条件**: 进入休眠模式
- **测试步骤**:
  1. 写入保持寄存器
  2. 进入休眠模式
  3. 唤醒后读取保持值
- **预期结果**: 唤醒后数据保持正确
- **边界条件**: 多次休眠唤醒、电源完全关断
- **关联需求**: 1.2 功耗优化策略

### FE_015: 时钟门控控制

- **描述**: PMU应能够控制各模块的时钟门控，实现20-30%功耗节省
- **前置条件**: 时钟控制器工作正常
- **测试步骤**:
  1. 配置时钟门控
  2. 观察时钟门控信号
- **预期结果**: 时钟门控信号正确
- **边界条件**: 快速门控切换、时钟同步
- **关联需求**: 1.2 功耗优化策略

### FE_016: 过压保护

- **描述**: PMU应检测过压并立即关断相关电源域
- **前置条件**: 电压监控正常
- **测试步骤**:
  1. 模拟过压条件
  2. 观察保护响应
- **预期结果**: 检测到过压并关断
- **边界条件**: 轻微过压、严重过压
- **关联需求**: 9.2 故障处理

### FE_017: 欠压保护

- **描述**: PMU应检测欠压并触发系统复位
- **前置条件**: 电压监控正常
- **测试步骤**:
  1. 模拟欠压条件
  2. 观察保护响应
- **预期结果**: 检测到欠压并复位
- **边界条件**: 轻微欠压、严重欠压
- **关联需求**: 9.2 故障处理

### FE_018: 过流保护

- **描述**: PMU应检测过流并执行降频或关断
- **前置条件**: 电流监控正常
- **测试步骤**:
  1. 模拟过流条件
  2. 观察保护响应
- **预期结果**: 检测到过流并降频/关断
- **边界条件**: 瞬间过流、持续过流
- **关联需求**: 9.2 故障处理

### FE_019: 过温保护

- **描述**: PMU应检测过温并执行降频或关断
- **前置条件**: 温度监控正常
- **测试步骤**:
  1. 模拟过温条件
  2. 观察保护响应
- **预期结果**: 检测到过温并降频/关断
- **边界条件**: 轻微过温、严重过温
- **关联需求**: 8.2 热管理策略

### FE_020: 看门狗超时

- **描述**: 看门狗超时后应触发系统复位
- **前置条件**: 看门狗已使能
- **测试步骤**:
  1. 配置看门狗超时时间
  2. 不喂狗
- **预期结果**: 超时后系统复位
- **边界条件**: 最小/最大超时
- **关联需求**: 9.2 故障处理

### FE_021: 电压监测中断

- **描述**: PMU应在电压超出阈值时触发中断
- **前置条件**: 中断控制器正常
- **测试步骤**:
  1. 配置电压阈值
  2. 模拟超阈值条件
  3. 检查中断
- **预期结果**: 触发电压中断
- **边界条件**: 超过上限、低于下限
- **关联需求**: 4.1 PMU功能

### FE_022: 温度告警中断

- **描述**: PMU应在温度超出阈值时触发中断
- **前置条件**: 中断控制器正常
- **测试步骤**:
  1. 配置温度阈值
  2. 模拟超阈值条件
  3. 检查中断
- **预期结果**: 触发温度中断
- **边界条件**: 超过高温阈值、低于低温阈值
- **关联需求**: 4.1 PMU功能

### FE_023: 功耗超限中断

- **描述**: PMU应在功耗超出预算时触发中断
- **前置条件**: 功耗监控正常
- **测试步骤**:
  1. 配置功耗预算
  2. 模拟超预算条件
  3. 检查中断
- **预期结果**: 触发功耗中断
- **边界条件**: 动态超限、静态超限
- **关联需求**: 7.2 功耗预算

### FE_024: 电源状态中断

- **描述**: PMU应在电源状态变化时触发中断
- **前置条件**: 中断控制器正常
- **测试步骤**:
  1. 配置状态中断使能
  2. 触发电源状态变化
  3. 检查中断
- **预期结果**: 触发状态中断
- **边界条件**: 上电、下电、模式切换
- **关联需求**: 4.1 PMU功能

### FE_025: APB3接口

- **描述**: PMU应提供APB3接口供CPU配置和控制
- **前置条件**: APB总线正常
- **测试步骤**:
  1. 通过APB读写寄存器
  2. 验证读写正确性
- **预期结果**: APB读写正确
- **边界条件**: 非法地址、连续读写
- **关联需求**: 系统集成需求

### FE_026: 独立RTC域

- **描述**: PD_RTC应独立供电，支持1.2V RTC域
- **前置条件**: RTC电源正常
- **测试步骤**:
  1. 检查RTC域供电
  2. 验证RTC功能
- **预期结果**: RTC域独立工作
- **边界条件**: 主电源关断、RTC唤醒
- **关联需求**: 2.2 电源域详情

### FE_027: 异步复位同步

- **描述**: PMU应正确处理多时钟域的异步复位
- **前置条件**: 复位信号正常
- **测试步骤**:
  1. 触发异步复位
  2. 验证各域同步释放
- **预期结果**: 复位同步正确
- **边界条件**: 异步复位断言/释放
- **关联需求**: 架构规范

### FE_028: 电源域隔离

- **描述**: PMU应控制电源域间的信号隔离
- **前置条件**: 隔离单元正常
- **测试步骤**:
  1. 关断电源域
  2. 检查隔离信号
- **预期结果**: 隔离信号正确断言
- **边界条件**: 快速上下电
- **关联需求**: 架构规范

---

## 验证资源预估

| 类别 | 预估数量 | 说明 |
|------|----------|------|
| **功能测试用例** | 80+ | 覆盖所有Feature |
| **异常测试用例** | 50+ | 故障注入、边界条件 |
| **回归测试** | 每日执行 | 全量测试套件 |
| **仿真时间** | 500+小时 | 覆盖所有场景 |

---

## 与Spec追溯矩阵

| Spec章节 | 关联Feature |
|----------|-------------|
| 1.1 电源管理设计目标 | FE_001, FE_002, FE_003, FE_007 |
| 1.2 功耗优化策略 | FE_008, FE_009, FE_014, FE_015 |
| 2.1 电源域定义 | FE_001, FE_026, FE_027, FE_028 |
| 3.2 电压监控 | FE_004, FE_016, FE_017, FE_021 |
| 4.1 PMU功能 | FE_010, FE_021~FE_024, FE_025 |
| 5.1 DVFS策略 | FE_007 |
| 6.1 低功耗模式定义 | FE_011, FE_012 |
| 6.2 唤醒源 | FE_012 |
| 7.1 功耗监测 | FE_005, FE_006, FE_008, FE_009 |
| 7.2 功耗预算 | FE_008, FE_009, FE_023 |
| 8.1 温度传感器 | FE_005, FE_019, FE_022 |
| 8.2 热管理策略 | FE_019, FE_022 |
| 9.2 故障处理 | FE_016~FE_020 |

---

**文档版本**: V1.0  
**创建日期**: 2026-01-19  
**状态**: 已交付DV
