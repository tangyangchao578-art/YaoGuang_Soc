# Safety Island 验证计划

| 文档版本 | V1.0 |
|---------|------|
| 创建日期 | 2026-01-18 |
| 状态 | 进行中 |
| ASIL 等级 | ASIL-D |

---

## 1. 模块概述

### 1.1 功能描述
Safety Island 是 YaoGuang SoC 的安全关键模块，采用双核锁步架构实现 ASIL-D 安全等级。

### 1.2 验证范围
- Cortex-R52 双核锁步处理器
- ECC 内存控制器
- 看门狗定时器
- 故障注入单元
- 错误报告单元
- 时钟复位安全监控

---

## 2. 测试点列表

### 2.1 双核锁步测试

| ID | 测试点 | 优先级 | 类型 | 期望结果 |
|----|--------|--------|------|----------|
| SI-LOCK-001 | Primary Core 执行 | P0 | 功能 | 正确执行 |
| SI-LOCK-002 | Shadow Core 执行 | P0 | 功能 | 正确执行 |
| SI-LOCK-003 | 结果比较器 | P0 | 功能 | 差异检测 |
| SI-LOCK-004 | 错误响应时间 | P0 | 时序 | < 5 cycles |
| SI-LOCK-005 | 错误码记录 | P0 | 功能 | 32bit 正确 |
| SI-LOCK-006 | 单比特错误检测 | P0 | 异常 | 100% 检测 |
| SI-LOCK-007 | 双比特错误检测 | P0 | 异常 | 检测 |

### 2.2 ECC 测试

| ID | 测试点 | 优先级 | 类型 | 期望结果 |
|----|--------|--------|------|----------|
| SI-ECC-001 | SECDED 纠正 | P0 | 功能 | 单错误纠正 |
| SI-ECC-002 | 双错误检测 | P0 | 异常 | 检测 |
| SI-ECC-003 | 校验码生成 | P0 | 功能 | 正确 |
| SI-ECC-004 | 错误中断 | P0 | 功能 | 触发 |
| SI-ECC-005 | 错误计数 | P0 | 功能 | 正确计数 |
| SI-ECC-006 | ECC 旁路 | P1 | 功能 | 可用 |

### 2.3 看门狗测试

| ID | 测试点 | 优先级 | 类型 | 期望结果 |
|----|--------|--------|------|----------|
| SI-WDG-001 | 内部看门狗 | P0 | 功能 | 超时复位 |
| SI-WDG-002 | 窗口看门狗 | P0 | 功能 | 窗口检测 |
| SI-WDG-003 | 失效安全响应 | P0 | 功能 | 触发 |

### 2.4 故障注入测试

| ID | 测试点 | 优先级 | 类型 | 期望结果 |
|----|--------|--------|------|----------|
| SI-FLT-001 | 单比特注入 | P0 | 异常 | 检测 |
| SI-FLT-002 | 多比特注入 | P0 | 异常 | 检测 |
| SI-FLT-003 | 永久故障 | P0 | 异常 | 检测 |

---

## 3. 验证环境

### 3.1 UVM 环境结构

```
safety_island_tb/
├── safety_island_env.sv
├── safety_island_agent.sv
├── safety_island_scoreboard.sv
├── safety_island_coverage.sv
└── safety_island_assertions.sv
```

### 3.2 接口信号

| 信号名 | 方向 | 宽度 | 描述 |
|--------|------|------|------|
| clk | input | 1 | 时钟 |
| rst_n | input | 1 | 复位 |
| axi4_if | master/slave | - | AXI4 接口 |
| apb_if | master | - | APB 接口 |
| irq | output | 64 | 中断 |

---

## 4. 覆盖率要求

| 覆盖率类型 | 目标 |
|------------|------|
| 代码覆盖率 | ≥ 95% |
| 功能覆盖率 | 100% |
| 断言覆盖率 | ≥ 90% |
| 故障注入覆盖率 | 100% |

---

## 5. 测试用例清单

| 用例名称 | 对应测试点 | 优先级 |
|----------|------------|--------|
| test_lockstep_basic | SI-LOCK-001~003 | P0 |
| test_lockstep_error | SI-LOCK-004~007 | P0 |
| test_ecc_correct | SI-ECC-001~003 | P0 |
| test_ecc_error | SI-ECC-004~006 | P0 |
| test_watchdog | SI-WDG-001~003 | P0 |
| test_fault_injection | SI-FLT-001~003 | P0 |

---

**创建日期**: 2026-01-18
