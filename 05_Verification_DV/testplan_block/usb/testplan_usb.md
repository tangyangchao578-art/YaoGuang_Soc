# USB Controller 验证计划

| 文档版本 | V1.0 |
|---------|------|
| 创建日期 | 2026-01-18 |
| 状态 | 进行中 |
| ASIL 等级 | QM |

---

## 1. 模块概述

### 1.1 功能描述
USB 3.2 控制器，支持主机和设备模式。

### 1.2 验证范围
- USB 3.2 主机控制器
- USB 3.2 设备控制器
- USB 2.0 PHY 接口
- DMA 引擎

---

## 2. 测试点列表

### 2.1 设备枚举测试

| ID | 测试点 | 优先级 | 类型 | 期望结果 |
|----|--------|--------|------|----------|
| USB-ENUM-001 | 端口检测 | P0 | 功能 | 正确 |
| USB-ENUM-001 | 设备描述符 | P0 | 功能 | 正确 |
| USB-ENUM-002 | 配置描述符 | P0 | 功能 | 正确 |
| USB-ENUM-003 | 端点配置 | P0 | 功能 | 正确 |
| USB-ENUM-004 | 地址分配 | P0 | 功能 | 正确 |

### 2.2 数据传输测试

| ID | 测试点 | 优先级 | 类型 | 期望结果 |
|----|--------|--------|------|----------|
| USB-DATA-001 | 控制传输 | P0 | 功能 | 正确 |
| USB-DATA-002 | 批量传输 | P0 | 功能 | 正确 |
| USB-DATA-003 | 中断传输 | P0 | 功能 | 正确 |
| USB-DATA-004 | 同步传输 | P1 | 功能 | 正确 |
| USB-DATA-005 | 双向传输 | P0 | 功能 | 正确 |

### 2.3 DMA 测试

| ID | 测试点 | 优先级 | 类型 | 期望结果 |
|----|--------|--------|------|----------|
| USB-DMA-001 | 描述符链 | P0 | 功能 | 正确 |
| USB-DMA-002 | 环形模式 | P0 | 功能 | 正确 |
| USB-DMA-003 | 分散模式 | P1 | 功能 | 正确 |
| USB-DMA-004 | 传输完成 | P0 | 功能 | 正确 |

### 2.4 错误处理测试

| ID | 测试点 | 优先级 | 类型 | 期望结果 |
|----|--------|--------|------|----------|
| USB-ERR-001 | CRC 错误 | P0 | 异常 | 检测 |
| USB-ERR-002 | 超时错误 | P0 | 异常 | 检测 |
| USB-ERR-003 | 令牌错误 | P0 | 异常 | 检测 |
| USB-ERR-004 | 错误恢复 | P0 | 功能 | 正确 |

### 2.5 电源管理测试

| ID | 测试点 | 优先级 | 类型 | 期望结果 |
|----|--------|--------|------|----------|
| USB-PWR-001 | U0 状态 | P0 | 功能 | 正确 |
| USB-PWR-002 | U1 状态 | P1 | 功能 | 正确 |
| USB-PWR-003 | U2 状态 | P1 | 功能 | 正确 |
| USB-PWR-004 | U3 状态 | P0 | 功能 | 正确 |
| USB-PWR-005 | 远程唤醒 | P0 | 功能 | 正确 |

---

## 3. 验证环境

```
usb_tb/
├── usb_env.sv
├── usb_agent.sv
├── usb_scoreboard.sv
└── usb_coverage.sv
```

---

## 4. 覆盖率要求

| 覆盖率类型 | 目标 |
|------------|------|
| 代码覆盖率 | ≥ 95% |
| 功能覆盖率 | 100% |
| 断言覆盖率 | ≥ 90% |

---

## 5. 测试用例清单

| 用例名称 | 对应测试点 | 优先级 |
|----------|------------|--------|
| test_usb_enumeration | USB-ENUM-001~004 | P0 |
| test_usb_transfer | USB-DATA-001~005 | P0 |
| test_usb_dma | USB-DMA-001~004 | P0 |
| test_usb_error | USB-ERR-001~004 | P0 |
| test_usb_power_mgmt | USB-PWR-001~005 | P0 |

---

**创建日期**: 2026-01-18
